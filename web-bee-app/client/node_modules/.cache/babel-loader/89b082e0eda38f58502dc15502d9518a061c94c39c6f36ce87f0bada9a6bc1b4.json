{"ast":null,"code":"/*\r\n * Copyright 2016 Red Hat, Inc. and/or its affiliates\r\n * and other contributors as indicated by the @author tags.\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\nfunction Keycloak(config) {\n  if (!(this instanceof Keycloak)) {\n    throw new Error(\"The 'Keycloak' constructor must be invoked with 'new'.\");\n  }\n  if (typeof config !== 'string' && !isObject(config)) {\n    throw new Error(\"The 'Keycloak' constructor must be provided with a configuration object, or a URL to a JSON configuration file.\");\n  }\n  if (isObject(config)) {\n    const requiredProperties = 'oidcProvider' in config ? ['clientId'] : ['url', 'realm', 'clientId'];\n    for (const property of requiredProperties) {\n      if (!config[property]) {\n        throw new Error(`The configuration object is missing the required '${property}' property.`);\n      }\n    }\n  }\n  var kc = this;\n  var adapter;\n  var refreshQueue = [];\n  var callbackStorage;\n  var loginIframe = {\n    enable: true,\n    callbackList: [],\n    interval: 5\n  };\n  kc.didInitialize = false;\n  var useNonce = true;\n  var logInfo = createLogger(console.info);\n  var logWarn = createLogger(console.warn);\n  if (!globalThis.isSecureContext) {\n    logWarn(\"[KEYCLOAK] Keycloak JS must be used in a 'secure context' to function properly as it relies on browser APIs that are otherwise not available.\\n\" + \"Continuing to run your application insecurely will lead to unexpected behavior and breakage.\\n\\n\" + \"For more information see: https://developer.mozilla.org/en-US/docs/Web/Security/Secure_Contexts\");\n  }\n  kc.init = function (initOptions = {}) {\n    if (kc.didInitialize) {\n      throw new Error(\"A 'Keycloak' instance can only be initialized once.\");\n    }\n    kc.didInitialize = true;\n    kc.authenticated = false;\n    callbackStorage = createCallbackStorage();\n    var adapters = ['default', 'cordova', 'cordova-native'];\n    if (adapters.indexOf(initOptions.adapter) > -1) {\n      adapter = loadAdapter(initOptions.adapter);\n    } else if (typeof initOptions.adapter === \"object\") {\n      adapter = initOptions.adapter;\n    } else {\n      if (window.Cordova || window.cordova) {\n        adapter = loadAdapter('cordova');\n      } else {\n        adapter = loadAdapter();\n      }\n    }\n    if (typeof initOptions.useNonce !== 'undefined') {\n      useNonce = initOptions.useNonce;\n    }\n    if (typeof initOptions.checkLoginIframe !== 'undefined') {\n      loginIframe.enable = initOptions.checkLoginIframe;\n    }\n    if (initOptions.checkLoginIframeInterval) {\n      loginIframe.interval = initOptions.checkLoginIframeInterval;\n    }\n    if (initOptions.onLoad === 'login-required') {\n      kc.loginRequired = true;\n    }\n    if (initOptions.responseMode) {\n      if (initOptions.responseMode === 'query' || initOptions.responseMode === 'fragment') {\n        kc.responseMode = initOptions.responseMode;\n      } else {\n        throw 'Invalid value for responseMode';\n      }\n    }\n    if (initOptions.flow) {\n      switch (initOptions.flow) {\n        case 'standard':\n          kc.responseType = 'code';\n          break;\n        case 'implicit':\n          kc.responseType = 'id_token token';\n          break;\n        case 'hybrid':\n          kc.responseType = 'code id_token token';\n          break;\n        default:\n          throw 'Invalid value for flow';\n      }\n      kc.flow = initOptions.flow;\n    }\n    if (initOptions.timeSkew != null) {\n      kc.timeSkew = initOptions.timeSkew;\n    }\n    if (initOptions.redirectUri) {\n      kc.redirectUri = initOptions.redirectUri;\n    }\n    if (initOptions.silentCheckSsoRedirectUri) {\n      kc.silentCheckSsoRedirectUri = initOptions.silentCheckSsoRedirectUri;\n    }\n    if (typeof initOptions.silentCheckSsoFallback === 'boolean') {\n      kc.silentCheckSsoFallback = initOptions.silentCheckSsoFallback;\n    } else {\n      kc.silentCheckSsoFallback = true;\n    }\n    if (typeof initOptions.pkceMethod !== \"undefined\") {\n      if (initOptions.pkceMethod !== \"S256\" && initOptions.pkceMethod !== false) {\n        throw new TypeError(`Invalid value for pkceMethod', expected 'S256' or false but got ${initOptions.pkceMethod}.`);\n      }\n      kc.pkceMethod = initOptions.pkceMethod;\n    } else {\n      kc.pkceMethod = \"S256\";\n    }\n    if (typeof initOptions.enableLogging === 'boolean') {\n      kc.enableLogging = initOptions.enableLogging;\n    } else {\n      kc.enableLogging = false;\n    }\n    if (initOptions.logoutMethod === 'POST') {\n      kc.logoutMethod = 'POST';\n    } else {\n      kc.logoutMethod = 'GET';\n    }\n    if (typeof initOptions.scope === 'string') {\n      kc.scope = initOptions.scope;\n    }\n    if (typeof initOptions.acrValues === 'string') {\n      kc.acrValues = initOptions.acrValues;\n    }\n    if (typeof initOptions.messageReceiveTimeout === 'number' && initOptions.messageReceiveTimeout > 0) {\n      kc.messageReceiveTimeout = initOptions.messageReceiveTimeout;\n    } else {\n      kc.messageReceiveTimeout = 10000;\n    }\n    if (!kc.responseMode) {\n      kc.responseMode = 'fragment';\n    }\n    if (!kc.responseType) {\n      kc.responseType = 'code';\n      kc.flow = 'standard';\n    }\n    var promise = createPromise();\n    var initPromise = createPromise();\n    initPromise.promise.then(function () {\n      kc.onReady && kc.onReady(kc.authenticated);\n      promise.setSuccess(kc.authenticated);\n    }).catch(function (error) {\n      promise.setError(error);\n    });\n    var configPromise = loadConfig();\n    function onLoad() {\n      var doLogin = function (prompt) {\n        if (!prompt) {\n          options.prompt = 'none';\n        }\n        if (initOptions.locale) {\n          options.locale = initOptions.locale;\n        }\n        kc.login(options).then(function () {\n          initPromise.setSuccess();\n        }).catch(function (error) {\n          initPromise.setError(error);\n        });\n      };\n      var checkSsoSilently = async function () {\n        var ifrm = document.createElement(\"iframe\");\n        var src = await kc.createLoginUrl({\n          prompt: 'none',\n          redirectUri: kc.silentCheckSsoRedirectUri\n        });\n        ifrm.setAttribute(\"src\", src);\n        ifrm.setAttribute(\"sandbox\", \"allow-storage-access-by-user-activation allow-scripts allow-same-origin\");\n        ifrm.setAttribute(\"title\", \"keycloak-silent-check-sso\");\n        ifrm.style.display = \"none\";\n        document.body.appendChild(ifrm);\n        var messageCallback = function (event) {\n          if (event.origin !== window.location.origin || ifrm.contentWindow !== event.source) {\n            return;\n          }\n          var oauth = parseCallback(event.data);\n          processCallback(oauth, initPromise);\n          document.body.removeChild(ifrm);\n          window.removeEventListener(\"message\", messageCallback);\n        };\n        window.addEventListener(\"message\", messageCallback);\n      };\n      var options = {};\n      switch (initOptions.onLoad) {\n        case 'check-sso':\n          if (loginIframe.enable) {\n            setupCheckLoginIframe().then(function () {\n              checkLoginIframe().then(function (unchanged) {\n                if (!unchanged) {\n                  kc.silentCheckSsoRedirectUri ? checkSsoSilently() : doLogin(false);\n                } else {\n                  initPromise.setSuccess();\n                }\n              }).catch(function (error) {\n                initPromise.setError(error);\n              });\n            });\n          } else {\n            kc.silentCheckSsoRedirectUri ? checkSsoSilently() : doLogin(false);\n          }\n          break;\n        case 'login-required':\n          doLogin(true);\n          break;\n        default:\n          throw 'Invalid value for onLoad';\n      }\n    }\n    function processInit() {\n      var callback = parseCallback(window.location.href);\n      if (callback) {\n        window.history.replaceState(window.history.state, null, callback.newUrl);\n      }\n      if (callback && callback.valid) {\n        return setupCheckLoginIframe().then(function () {\n          processCallback(callback, initPromise);\n        }).catch(function (error) {\n          initPromise.setError(error);\n        });\n      }\n      if (initOptions.token && initOptions.refreshToken) {\n        setToken(initOptions.token, initOptions.refreshToken, initOptions.idToken);\n        if (loginIframe.enable) {\n          setupCheckLoginIframe().then(function () {\n            checkLoginIframe().then(function (unchanged) {\n              if (unchanged) {\n                kc.onAuthSuccess && kc.onAuthSuccess();\n                initPromise.setSuccess();\n                scheduleCheckIframe();\n              } else {\n                initPromise.setSuccess();\n              }\n            }).catch(function (error) {\n              initPromise.setError(error);\n            });\n          });\n        } else {\n          kc.updateToken(-1).then(function () {\n            kc.onAuthSuccess && kc.onAuthSuccess();\n            initPromise.setSuccess();\n          }).catch(function (error) {\n            kc.onAuthError && kc.onAuthError();\n            if (initOptions.onLoad) {\n              onLoad();\n            } else {\n              initPromise.setError(error);\n            }\n          });\n        }\n      } else if (initOptions.onLoad) {\n        onLoad();\n      } else {\n        initPromise.setSuccess();\n      }\n    }\n    configPromise.then(function () {\n      check3pCookiesSupported().then(processInit).catch(function (error) {\n        promise.setError(error);\n      });\n    });\n    configPromise.catch(function (error) {\n      promise.setError(error);\n    });\n    return promise.promise;\n  };\n  kc.login = function (options) {\n    return adapter.login(options);\n  };\n  function generateRandomData(len) {\n    if (typeof crypto === \"undefined\" || typeof crypto.getRandomValues === \"undefined\") {\n      throw new Error(\"Web Crypto API is not available.\");\n    }\n    return crypto.getRandomValues(new Uint8Array(len));\n  }\n  function generateCodeVerifier(len) {\n    return generateRandomString(len, 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789');\n  }\n  function generateRandomString(len, alphabet) {\n    var randomData = generateRandomData(len);\n    var chars = new Array(len);\n    for (var i = 0; i < len; i++) {\n      chars[i] = alphabet.charCodeAt(randomData[i] % alphabet.length);\n    }\n    return String.fromCharCode.apply(null, chars);\n  }\n  async function generatePkceChallenge(pkceMethod, codeVerifier) {\n    if (pkceMethod !== \"S256\") {\n      throw new TypeError(`Invalid value for 'pkceMethod', expected 'S256' but got '${pkceMethod}'.`);\n    }\n\n    // hash codeVerifier, then encode as url-safe base64 without padding\n    const hashBytes = new Uint8Array(await sha256Digest(codeVerifier));\n    const encodedHash = bytesToBase64(hashBytes).replace(/\\+/g, '-').replace(/\\//g, '_').replace(/\\=/g, '');\n    return encodedHash;\n  }\n  function buildClaimsParameter(requestedAcr) {\n    var claims = {\n      id_token: {\n        acr: requestedAcr\n      }\n    };\n    return JSON.stringify(claims);\n  }\n  kc.createLoginUrl = async function (options) {\n    var state = createUUID();\n    var nonce = createUUID();\n    var redirectUri = adapter.redirectUri(options);\n    var callbackState = {\n      state: state,\n      nonce: nonce,\n      redirectUri: encodeURIComponent(redirectUri),\n      loginOptions: options\n    };\n    if (options && options.prompt) {\n      callbackState.prompt = options.prompt;\n    }\n    var baseUrl;\n    if (options && options.action == 'register') {\n      baseUrl = kc.endpoints.register();\n    } else {\n      baseUrl = kc.endpoints.authorize();\n    }\n    var scope = options && options.scope || kc.scope;\n    if (!scope) {\n      // if scope is not set, default to \"openid\"\n      scope = \"openid\";\n    } else if (scope.indexOf(\"openid\") === -1) {\n      // if openid scope is missing, prefix the given scopes with it\n      scope = \"openid \" + scope;\n    }\n    var url = baseUrl + '?client_id=' + encodeURIComponent(kc.clientId) + '&redirect_uri=' + encodeURIComponent(redirectUri) + '&state=' + encodeURIComponent(state) + '&response_mode=' + encodeURIComponent(kc.responseMode) + '&response_type=' + encodeURIComponent(kc.responseType) + '&scope=' + encodeURIComponent(scope);\n    if (useNonce) {\n      url = url + '&nonce=' + encodeURIComponent(nonce);\n    }\n    if (options && options.prompt) {\n      url += '&prompt=' + encodeURIComponent(options.prompt);\n    }\n    if (options && typeof options.maxAge === 'number') {\n      url += '&max_age=' + encodeURIComponent(options.maxAge);\n    }\n    if (options && options.loginHint) {\n      url += '&login_hint=' + encodeURIComponent(options.loginHint);\n    }\n    if (options && options.idpHint) {\n      url += '&kc_idp_hint=' + encodeURIComponent(options.idpHint);\n    }\n    if (options && options.action && options.action != 'register') {\n      url += '&kc_action=' + encodeURIComponent(options.action);\n    }\n    if (options && options.locale) {\n      url += '&ui_locales=' + encodeURIComponent(options.locale);\n    }\n    if (options && options.acr) {\n      var claimsParameter = buildClaimsParameter(options.acr);\n      url += '&claims=' + encodeURIComponent(claimsParameter);\n    }\n    if (options && options.acrValues || kc.acrValues) {\n      url += '&acr_values=' + encodeURIComponent(options.acrValues || kc.acrValues);\n    }\n    if (kc.pkceMethod) {\n      try {\n        const codeVerifier = generateCodeVerifier(96);\n        const pkceChallenge = await generatePkceChallenge(kc.pkceMethod, codeVerifier);\n        callbackState.pkceCodeVerifier = codeVerifier;\n        url += '&code_challenge=' + pkceChallenge;\n        url += '&code_challenge_method=' + kc.pkceMethod;\n      } catch (error) {\n        throw new Error(\"Failed to generate PKCE challenge.\", {\n          cause: error\n        });\n      }\n    }\n    callbackStorage.add(callbackState);\n    return url;\n  };\n  kc.logout = function (options) {\n    return adapter.logout(options);\n  };\n  kc.createLogoutUrl = function (options) {\n    const logoutMethod = options?.logoutMethod ?? kc.logoutMethod;\n    if (logoutMethod === 'POST') {\n      return kc.endpoints.logout();\n    }\n    var url = kc.endpoints.logout() + '?client_id=' + encodeURIComponent(kc.clientId) + '&post_logout_redirect_uri=' + encodeURIComponent(adapter.redirectUri(options, false));\n    if (kc.idToken) {\n      url += '&id_token_hint=' + encodeURIComponent(kc.idToken);\n    }\n    return url;\n  };\n  kc.register = function (options) {\n    return adapter.register(options);\n  };\n  kc.createRegisterUrl = async function (options) {\n    if (!options) {\n      options = {};\n    }\n    options.action = 'register';\n    return await kc.createLoginUrl(options);\n  };\n  kc.createAccountUrl = function (options) {\n    var realm = getRealmUrl();\n    var url = undefined;\n    if (typeof realm !== 'undefined') {\n      url = realm + '/account' + '?referrer=' + encodeURIComponent(kc.clientId) + '&referrer_uri=' + encodeURIComponent(adapter.redirectUri(options));\n    }\n    return url;\n  };\n  kc.accountManagement = function () {\n    return adapter.accountManagement();\n  };\n  kc.hasRealmRole = function (role) {\n    var access = kc.realmAccess;\n    return !!access && access.roles.indexOf(role) >= 0;\n  };\n  kc.hasResourceRole = function (role, resource) {\n    if (!kc.resourceAccess) {\n      return false;\n    }\n    var access = kc.resourceAccess[resource || kc.clientId];\n    return !!access && access.roles.indexOf(role) >= 0;\n  };\n  kc.loadUserProfile = function () {\n    var url = getRealmUrl() + '/account';\n    var req = new XMLHttpRequest();\n    req.open('GET', url, true);\n    req.setRequestHeader('Accept', 'application/json');\n    req.setRequestHeader('Authorization', 'bearer ' + kc.token);\n    var promise = createPromise();\n    req.onreadystatechange = function () {\n      if (req.readyState == 4) {\n        if (req.status == 200) {\n          kc.profile = JSON.parse(req.responseText);\n          promise.setSuccess(kc.profile);\n        } else {\n          promise.setError();\n        }\n      }\n    };\n    req.send();\n    return promise.promise;\n  };\n  kc.loadUserInfo = function () {\n    var url = kc.endpoints.userinfo();\n    var req = new XMLHttpRequest();\n    req.open('GET', url, true);\n    req.setRequestHeader('Accept', 'application/json');\n    req.setRequestHeader('Authorization', 'bearer ' + kc.token);\n    var promise = createPromise();\n    req.onreadystatechange = function () {\n      if (req.readyState == 4) {\n        if (req.status == 200) {\n          kc.userInfo = JSON.parse(req.responseText);\n          promise.setSuccess(kc.userInfo);\n        } else {\n          promise.setError();\n        }\n      }\n    };\n    req.send();\n    return promise.promise;\n  };\n  kc.isTokenExpired = function (minValidity) {\n    if (!kc.tokenParsed || !kc.refreshToken && kc.flow != 'implicit') {\n      throw 'Not authenticated';\n    }\n    if (kc.timeSkew == null) {\n      logInfo('[KEYCLOAK] Unable to determine if token is expired as timeskew is not set');\n      return true;\n    }\n    var expiresIn = kc.tokenParsed['exp'] - Math.ceil(new Date().getTime() / 1000) + kc.timeSkew;\n    if (minValidity) {\n      if (isNaN(minValidity)) {\n        throw 'Invalid minValidity';\n      }\n      expiresIn -= minValidity;\n    }\n    return expiresIn < 0;\n  };\n  kc.updateToken = function (minValidity) {\n    var promise = createPromise();\n    if (!kc.refreshToken) {\n      promise.setError();\n      return promise.promise;\n    }\n    minValidity = minValidity || 5;\n    var exec = function () {\n      var refreshToken = false;\n      if (minValidity == -1) {\n        refreshToken = true;\n        logInfo('[KEYCLOAK] Refreshing token: forced refresh');\n      } else if (!kc.tokenParsed || kc.isTokenExpired(minValidity)) {\n        refreshToken = true;\n        logInfo('[KEYCLOAK] Refreshing token: token expired');\n      }\n      if (!refreshToken) {\n        promise.setSuccess(false);\n      } else {\n        var params = 'grant_type=refresh_token&' + 'refresh_token=' + kc.refreshToken;\n        var url = kc.endpoints.token();\n        refreshQueue.push(promise);\n        if (refreshQueue.length == 1) {\n          var req = new XMLHttpRequest();\n          req.open('POST', url, true);\n          req.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');\n          req.withCredentials = true;\n          params += '&client_id=' + encodeURIComponent(kc.clientId);\n          var timeLocal = new Date().getTime();\n          req.onreadystatechange = function () {\n            if (req.readyState == 4) {\n              if (req.status == 200) {\n                logInfo('[KEYCLOAK] Token refreshed');\n                timeLocal = (timeLocal + new Date().getTime()) / 2;\n                var tokenResponse = JSON.parse(req.responseText);\n                setToken(tokenResponse['access_token'], tokenResponse['refresh_token'], tokenResponse['id_token'], timeLocal);\n                kc.onAuthRefreshSuccess && kc.onAuthRefreshSuccess();\n                for (var p = refreshQueue.pop(); p != null; p = refreshQueue.pop()) {\n                  p.setSuccess(true);\n                }\n              } else {\n                logWarn('[KEYCLOAK] Failed to refresh token');\n                if (req.status == 400) {\n                  kc.clearToken();\n                }\n                kc.onAuthRefreshError && kc.onAuthRefreshError();\n                for (var p = refreshQueue.pop(); p != null; p = refreshQueue.pop()) {\n                  p.setError(true);\n                }\n              }\n            }\n          };\n          req.send(params);\n        }\n      }\n    };\n    if (loginIframe.enable) {\n      var iframePromise = checkLoginIframe();\n      iframePromise.then(function () {\n        exec();\n      }).catch(function (error) {\n        promise.setError(error);\n      });\n    } else {\n      exec();\n    }\n    return promise.promise;\n  };\n  kc.clearToken = function () {\n    if (kc.token) {\n      setToken(null, null, null);\n      kc.onAuthLogout && kc.onAuthLogout();\n      if (kc.loginRequired) {\n        kc.login();\n      }\n    }\n  };\n  function getRealmUrl() {\n    if (typeof kc.authServerUrl !== 'undefined') {\n      if (kc.authServerUrl.charAt(kc.authServerUrl.length - 1) == '/') {\n        return kc.authServerUrl + 'realms/' + encodeURIComponent(kc.realm);\n      } else {\n        return kc.authServerUrl + '/realms/' + encodeURIComponent(kc.realm);\n      }\n    } else {\n      return undefined;\n    }\n  }\n  function getOrigin() {\n    if (!window.location.origin) {\n      return window.location.protocol + \"//\" + window.location.hostname + (window.location.port ? ':' + window.location.port : '');\n    } else {\n      return window.location.origin;\n    }\n  }\n  function processCallback(oauth, promise) {\n    var code = oauth.code;\n    var error = oauth.error;\n    var prompt = oauth.prompt;\n    var timeLocal = new Date().getTime();\n    if (oauth['kc_action_status']) {\n      kc.onActionUpdate && kc.onActionUpdate(oauth['kc_action_status'], oauth['kc_action']);\n    }\n    if (error) {\n      if (prompt != 'none') {\n        if (oauth.error_description && oauth.error_description === \"authentication_expired\") {\n          kc.login(oauth.loginOptions);\n        } else {\n          var errorData = {\n            error: error,\n            error_description: oauth.error_description\n          };\n          kc.onAuthError && kc.onAuthError(errorData);\n          promise && promise.setError(errorData);\n        }\n      } else {\n        promise && promise.setSuccess();\n      }\n      return;\n    } else if (kc.flow != 'standard' && (oauth.access_token || oauth.id_token)) {\n      authSuccess(oauth.access_token, null, oauth.id_token, true);\n    }\n    if (kc.flow != 'implicit' && code) {\n      var params = 'code=' + code + '&grant_type=authorization_code';\n      var url = kc.endpoints.token();\n      var req = new XMLHttpRequest();\n      req.open('POST', url, true);\n      req.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');\n      params += '&client_id=' + encodeURIComponent(kc.clientId);\n      params += '&redirect_uri=' + oauth.redirectUri;\n      if (oauth.pkceCodeVerifier) {\n        params += '&code_verifier=' + oauth.pkceCodeVerifier;\n      }\n      req.withCredentials = true;\n      req.onreadystatechange = function () {\n        if (req.readyState == 4) {\n          if (req.status == 200) {\n            var tokenResponse = JSON.parse(req.responseText);\n            authSuccess(tokenResponse['access_token'], tokenResponse['refresh_token'], tokenResponse['id_token'], kc.flow === 'standard');\n            scheduleCheckIframe();\n          } else {\n            kc.onAuthError && kc.onAuthError();\n            promise && promise.setError();\n          }\n        }\n      };\n      req.send(params);\n    }\n    function authSuccess(accessToken, refreshToken, idToken, fulfillPromise) {\n      timeLocal = (timeLocal + new Date().getTime()) / 2;\n      setToken(accessToken, refreshToken, idToken, timeLocal);\n      if (useNonce && kc.idTokenParsed && kc.idTokenParsed.nonce != oauth.storedNonce) {\n        logInfo('[KEYCLOAK] Invalid nonce, clearing token');\n        kc.clearToken();\n        promise && promise.setError();\n      } else {\n        if (fulfillPromise) {\n          kc.onAuthSuccess && kc.onAuthSuccess();\n          promise && promise.setSuccess();\n        }\n      }\n    }\n  }\n  function loadConfig() {\n    var promise = createPromise();\n    var configUrl;\n    if (typeof config === 'string') {\n      configUrl = config;\n    }\n    function setupOidcEndoints(oidcConfiguration) {\n      if (!oidcConfiguration) {\n        kc.endpoints = {\n          authorize: function () {\n            return getRealmUrl() + '/protocol/openid-connect/auth';\n          },\n          token: function () {\n            return getRealmUrl() + '/protocol/openid-connect/token';\n          },\n          logout: function () {\n            return getRealmUrl() + '/protocol/openid-connect/logout';\n          },\n          checkSessionIframe: function () {\n            return getRealmUrl() + '/protocol/openid-connect/login-status-iframe.html';\n          },\n          thirdPartyCookiesIframe: function () {\n            return getRealmUrl() + '/protocol/openid-connect/3p-cookies/step1.html';\n          },\n          register: function () {\n            return getRealmUrl() + '/protocol/openid-connect/registrations';\n          },\n          userinfo: function () {\n            return getRealmUrl() + '/protocol/openid-connect/userinfo';\n          }\n        };\n      } else {\n        kc.endpoints = {\n          authorize: function () {\n            return oidcConfiguration.authorization_endpoint;\n          },\n          token: function () {\n            return oidcConfiguration.token_endpoint;\n          },\n          logout: function () {\n            if (!oidcConfiguration.end_session_endpoint) {\n              throw \"Not supported by the OIDC server\";\n            }\n            return oidcConfiguration.end_session_endpoint;\n          },\n          checkSessionIframe: function () {\n            if (!oidcConfiguration.check_session_iframe) {\n              throw \"Not supported by the OIDC server\";\n            }\n            return oidcConfiguration.check_session_iframe;\n          },\n          register: function () {\n            throw 'Redirection to \"Register user\" page not supported in standard OIDC mode';\n          },\n          userinfo: function () {\n            if (!oidcConfiguration.userinfo_endpoint) {\n              throw \"Not supported by the OIDC server\";\n            }\n            return oidcConfiguration.userinfo_endpoint;\n          }\n        };\n      }\n    }\n    if (configUrl) {\n      var req = new XMLHttpRequest();\n      req.open('GET', configUrl, true);\n      req.setRequestHeader('Accept', 'application/json');\n      req.onreadystatechange = function () {\n        if (req.readyState == 4) {\n          if (req.status == 200 || fileLoaded(req)) {\n            var config = JSON.parse(req.responseText);\n            kc.authServerUrl = config['auth-server-url'];\n            kc.realm = config['realm'];\n            kc.clientId = config['resource'];\n            setupOidcEndoints(null);\n            promise.setSuccess();\n          } else {\n            promise.setError();\n          }\n        }\n      };\n      req.send();\n    } else {\n      kc.clientId = config.clientId;\n      var oidcProvider = config['oidcProvider'];\n      if (!oidcProvider) {\n        kc.authServerUrl = config.url;\n        kc.realm = config.realm;\n        setupOidcEndoints(null);\n        promise.setSuccess();\n      } else {\n        if (typeof oidcProvider === 'string') {\n          var oidcProviderConfigUrl;\n          if (oidcProvider.charAt(oidcProvider.length - 1) == '/') {\n            oidcProviderConfigUrl = oidcProvider + '.well-known/openid-configuration';\n          } else {\n            oidcProviderConfigUrl = oidcProvider + '/.well-known/openid-configuration';\n          }\n          var req = new XMLHttpRequest();\n          req.open('GET', oidcProviderConfigUrl, true);\n          req.setRequestHeader('Accept', 'application/json');\n          req.onreadystatechange = function () {\n            if (req.readyState == 4) {\n              if (req.status == 200 || fileLoaded(req)) {\n                var oidcProviderConfig = JSON.parse(req.responseText);\n                setupOidcEndoints(oidcProviderConfig);\n                promise.setSuccess();\n              } else {\n                promise.setError();\n              }\n            }\n          };\n          req.send();\n        } else {\n          setupOidcEndoints(oidcProvider);\n          promise.setSuccess();\n        }\n      }\n    }\n    return promise.promise;\n  }\n  function fileLoaded(xhr) {\n    return xhr.status == 0 && xhr.responseText && xhr.responseURL.startsWith('file:');\n  }\n  function setToken(token, refreshToken, idToken, timeLocal) {\n    if (kc.tokenTimeoutHandle) {\n      clearTimeout(kc.tokenTimeoutHandle);\n      kc.tokenTimeoutHandle = null;\n    }\n    if (refreshToken) {\n      kc.refreshToken = refreshToken;\n      kc.refreshTokenParsed = decodeToken(refreshToken);\n    } else {\n      delete kc.refreshToken;\n      delete kc.refreshTokenParsed;\n    }\n    if (idToken) {\n      kc.idToken = idToken;\n      kc.idTokenParsed = decodeToken(idToken);\n    } else {\n      delete kc.idToken;\n      delete kc.idTokenParsed;\n    }\n    if (token) {\n      kc.token = token;\n      kc.tokenParsed = decodeToken(token);\n      kc.sessionId = kc.tokenParsed.sid;\n      kc.authenticated = true;\n      kc.subject = kc.tokenParsed.sub;\n      kc.realmAccess = kc.tokenParsed.realm_access;\n      kc.resourceAccess = kc.tokenParsed.resource_access;\n      if (timeLocal) {\n        kc.timeSkew = Math.floor(timeLocal / 1000) - kc.tokenParsed.iat;\n      }\n      if (kc.timeSkew != null) {\n        logInfo('[KEYCLOAK] Estimated time difference between browser and server is ' + kc.timeSkew + ' seconds');\n        if (kc.onTokenExpired) {\n          var expiresIn = (kc.tokenParsed['exp'] - new Date().getTime() / 1000 + kc.timeSkew) * 1000;\n          logInfo('[KEYCLOAK] Token expires in ' + Math.round(expiresIn / 1000) + ' s');\n          if (expiresIn <= 0) {\n            kc.onTokenExpired();\n          } else {\n            kc.tokenTimeoutHandle = setTimeout(kc.onTokenExpired, expiresIn);\n          }\n        }\n      }\n    } else {\n      delete kc.token;\n      delete kc.tokenParsed;\n      delete kc.subject;\n      delete kc.realmAccess;\n      delete kc.resourceAccess;\n      kc.authenticated = false;\n    }\n  }\n  function createUUID() {\n    if (typeof crypto === \"undefined\" || typeof crypto.randomUUID === \"undefined\") {\n      throw new Error(\"Web Crypto API is not available.\");\n    }\n    return crypto.randomUUID();\n  }\n  function parseCallback(url) {\n    var oauth = parseCallbackUrl(url);\n    if (!oauth) {\n      return;\n    }\n    var oauthState = callbackStorage.get(oauth.state);\n    if (oauthState) {\n      oauth.valid = true;\n      oauth.redirectUri = oauthState.redirectUri;\n      oauth.storedNonce = oauthState.nonce;\n      oauth.prompt = oauthState.prompt;\n      oauth.pkceCodeVerifier = oauthState.pkceCodeVerifier;\n      oauth.loginOptions = oauthState.loginOptions;\n    }\n    return oauth;\n  }\n  function parseCallbackUrl(url) {\n    var supportedParams;\n    switch (kc.flow) {\n      case 'standard':\n        supportedParams = ['code', 'state', 'session_state', 'kc_action_status', 'kc_action', 'iss'];\n        break;\n      case 'implicit':\n        supportedParams = ['access_token', 'token_type', 'id_token', 'state', 'session_state', 'expires_in', 'kc_action_status', 'kc_action', 'iss'];\n        break;\n      case 'hybrid':\n        supportedParams = ['access_token', 'token_type', 'id_token', 'code', 'state', 'session_state', 'expires_in', 'kc_action_status', 'kc_action', 'iss'];\n        break;\n    }\n    supportedParams.push('error');\n    supportedParams.push('error_description');\n    supportedParams.push('error_uri');\n    var queryIndex = url.indexOf('?');\n    var fragmentIndex = url.indexOf('#');\n    var newUrl;\n    var parsed;\n    if (kc.responseMode === 'query' && queryIndex !== -1) {\n      newUrl = url.substring(0, queryIndex);\n      parsed = parseCallbackParams(url.substring(queryIndex + 1, fragmentIndex !== -1 ? fragmentIndex : url.length), supportedParams);\n      if (parsed.paramsString !== '') {\n        newUrl += '?' + parsed.paramsString;\n      }\n      if (fragmentIndex !== -1) {\n        newUrl += url.substring(fragmentIndex);\n      }\n    } else if (kc.responseMode === 'fragment' && fragmentIndex !== -1) {\n      newUrl = url.substring(0, fragmentIndex);\n      parsed = parseCallbackParams(url.substring(fragmentIndex + 1), supportedParams);\n      if (parsed.paramsString !== '') {\n        newUrl += '#' + parsed.paramsString;\n      }\n    }\n    if (parsed && parsed.oauthParams) {\n      if (kc.flow === 'standard' || kc.flow === 'hybrid') {\n        if ((parsed.oauthParams.code || parsed.oauthParams.error) && parsed.oauthParams.state) {\n          parsed.oauthParams.newUrl = newUrl;\n          return parsed.oauthParams;\n        }\n      } else if (kc.flow === 'implicit') {\n        if ((parsed.oauthParams.access_token || parsed.oauthParams.error) && parsed.oauthParams.state) {\n          parsed.oauthParams.newUrl = newUrl;\n          return parsed.oauthParams;\n        }\n      }\n    }\n  }\n  function parseCallbackParams(paramsString, supportedParams) {\n    var p = paramsString.split('&');\n    var result = {\n      paramsString: '',\n      oauthParams: {}\n    };\n    for (var i = 0; i < p.length; i++) {\n      var split = p[i].indexOf(\"=\");\n      var key = p[i].slice(0, split);\n      if (supportedParams.indexOf(key) !== -1) {\n        result.oauthParams[key] = p[i].slice(split + 1);\n      } else {\n        if (result.paramsString !== '') {\n          result.paramsString += '&';\n        }\n        result.paramsString += p[i];\n      }\n    }\n    return result;\n  }\n  function createPromise() {\n    // Need to create a native Promise which also preserves the\n    // interface of the custom promise type previously used by the API\n    var p = {\n      setSuccess: function (result) {\n        p.resolve(result);\n      },\n      setError: function (result) {\n        p.reject(result);\n      }\n    };\n    p.promise = new Promise(function (resolve, reject) {\n      p.resolve = resolve;\n      p.reject = reject;\n    });\n    return p;\n  }\n\n  // Function to extend existing native Promise with timeout\n  function applyTimeoutToPromise(promise, timeout, errorMessage) {\n    var timeoutHandle = null;\n    var timeoutPromise = new Promise(function (resolve, reject) {\n      timeoutHandle = setTimeout(function () {\n        reject({\n          \"error\": errorMessage || \"Promise is not settled within timeout of \" + timeout + \"ms\"\n        });\n      }, timeout);\n    });\n    return Promise.race([promise, timeoutPromise]).finally(function () {\n      clearTimeout(timeoutHandle);\n    });\n  }\n  function setupCheckLoginIframe() {\n    var promise = createPromise();\n    if (!loginIframe.enable) {\n      promise.setSuccess();\n      return promise.promise;\n    }\n    if (loginIframe.iframe) {\n      promise.setSuccess();\n      return promise.promise;\n    }\n    var iframe = document.createElement('iframe');\n    loginIframe.iframe = iframe;\n    iframe.onload = function () {\n      var authUrl = kc.endpoints.authorize();\n      if (authUrl.charAt(0) === '/') {\n        loginIframe.iframeOrigin = getOrigin();\n      } else {\n        loginIframe.iframeOrigin = authUrl.substring(0, authUrl.indexOf('/', 8));\n      }\n      promise.setSuccess();\n    };\n    var src = kc.endpoints.checkSessionIframe();\n    iframe.setAttribute('src', src);\n    iframe.setAttribute('sandbox', 'allow-storage-access-by-user-activation allow-scripts allow-same-origin');\n    iframe.setAttribute('title', 'keycloak-session-iframe');\n    iframe.style.display = 'none';\n    document.body.appendChild(iframe);\n    var messageCallback = function (event) {\n      if (event.origin !== loginIframe.iframeOrigin || loginIframe.iframe.contentWindow !== event.source) {\n        return;\n      }\n      if (!(event.data == 'unchanged' || event.data == 'changed' || event.data == 'error')) {\n        return;\n      }\n      if (event.data != 'unchanged') {\n        kc.clearToken();\n      }\n      var callbacks = loginIframe.callbackList.splice(0, loginIframe.callbackList.length);\n      for (var i = callbacks.length - 1; i >= 0; --i) {\n        var promise = callbacks[i];\n        if (event.data == 'error') {\n          promise.setError();\n        } else {\n          promise.setSuccess(event.data == 'unchanged');\n        }\n      }\n    };\n    window.addEventListener('message', messageCallback, false);\n    return promise.promise;\n  }\n  function scheduleCheckIframe() {\n    if (loginIframe.enable) {\n      if (kc.token) {\n        setTimeout(function () {\n          checkLoginIframe().then(function (unchanged) {\n            if (unchanged) {\n              scheduleCheckIframe();\n            }\n          });\n        }, loginIframe.interval * 1000);\n      }\n    }\n  }\n  function checkLoginIframe() {\n    var promise = createPromise();\n    if (loginIframe.iframe && loginIframe.iframeOrigin) {\n      var msg = kc.clientId + ' ' + (kc.sessionId ? kc.sessionId : '');\n      loginIframe.callbackList.push(promise);\n      var origin = loginIframe.iframeOrigin;\n      if (loginIframe.callbackList.length == 1) {\n        loginIframe.iframe.contentWindow.postMessage(msg, origin);\n      }\n    } else {\n      promise.setSuccess();\n    }\n    return promise.promise;\n  }\n  function check3pCookiesSupported() {\n    var promise = createPromise();\n    if ((loginIframe.enable || kc.silentCheckSsoRedirectUri) && typeof kc.endpoints.thirdPartyCookiesIframe === 'function') {\n      var iframe = document.createElement('iframe');\n      iframe.setAttribute('src', kc.endpoints.thirdPartyCookiesIframe());\n      iframe.setAttribute('sandbox', 'allow-storage-access-by-user-activation allow-scripts allow-same-origin');\n      iframe.setAttribute('title', 'keycloak-3p-check-iframe');\n      iframe.style.display = 'none';\n      document.body.appendChild(iframe);\n      var messageCallback = function (event) {\n        if (iframe.contentWindow !== event.source) {\n          return;\n        }\n        if (event.data !== \"supported\" && event.data !== \"unsupported\") {\n          return;\n        } else if (event.data === \"unsupported\") {\n          logWarn(\"[KEYCLOAK] Your browser is blocking access to 3rd-party cookies, this means:\\n\\n\" + \" - It is not possible to retrieve tokens without redirecting to the Keycloak server (a.k.a. no support for silent authentication).\\n\" + \" - It is not possible to automatically detect changes to the session status (such as the user logging out in another tab).\\n\\n\" + \"For more information see: https://www.keycloak.org/docs/latest/securing_apps/#_modern_browsers\");\n          loginIframe.enable = false;\n          if (kc.silentCheckSsoFallback) {\n            kc.silentCheckSsoRedirectUri = false;\n          }\n        }\n        document.body.removeChild(iframe);\n        window.removeEventListener(\"message\", messageCallback);\n        promise.setSuccess();\n      };\n      window.addEventListener('message', messageCallback, false);\n    } else {\n      promise.setSuccess();\n    }\n    return applyTimeoutToPromise(promise.promise, kc.messageReceiveTimeout, \"Timeout when waiting for 3rd party check iframe message.\");\n  }\n  function loadAdapter(type) {\n    if (!type || type == 'default') {\n      return {\n        login: async function (options) {\n          window.location.assign(await kc.createLoginUrl(options));\n          return createPromise().promise;\n        },\n        logout: async function (options) {\n          const logoutMethod = options?.logoutMethod ?? kc.logoutMethod;\n          if (logoutMethod === \"GET\") {\n            window.location.replace(kc.createLogoutUrl(options));\n            return;\n          }\n          const logoutUrl = kc.createLogoutUrl(options);\n          const response = await fetch(logoutUrl, {\n            method: \"POST\",\n            headers: {\n              \"Content-Type\": \"application/x-www-form-urlencoded\"\n            },\n            body: new URLSearchParams({\n              id_token_hint: kc.idToken,\n              client_id: kc.clientId,\n              post_logout_redirect_uri: adapter.redirectUri(options, false)\n            })\n          });\n          if (response.redirected) {\n            window.location.href = response.url;\n            return;\n          }\n          if (response.ok) {\n            window.location.reload();\n            return;\n          }\n          throw new Error(\"Logout failed, request returned an error code.\");\n        },\n        register: async function (options) {\n          window.location.assign(await kc.createRegisterUrl(options));\n          return createPromise().promise;\n        },\n        accountManagement: function () {\n          var accountUrl = kc.createAccountUrl();\n          if (typeof accountUrl !== 'undefined') {\n            window.location.href = accountUrl;\n          } else {\n            throw \"Not supported by the OIDC server\";\n          }\n          return createPromise().promise;\n        },\n        redirectUri: function (options, encodeHash) {\n          if (arguments.length == 1) {\n            encodeHash = true;\n          }\n          if (options && options.redirectUri) {\n            return options.redirectUri;\n          } else if (kc.redirectUri) {\n            return kc.redirectUri;\n          } else {\n            return location.href;\n          }\n        }\n      };\n    }\n    if (type == 'cordova') {\n      loginIframe.enable = false;\n      var cordovaOpenWindowWrapper = function (loginUrl, target, options) {\n        if (window.cordova && window.cordova.InAppBrowser) {\n          // Use inappbrowser for IOS and Android if available\n          return window.cordova.InAppBrowser.open(loginUrl, target, options);\n        } else {\n          return window.open(loginUrl, target, options);\n        }\n      };\n      var shallowCloneCordovaOptions = function (userOptions) {\n        if (userOptions && userOptions.cordovaOptions) {\n          return Object.keys(userOptions.cordovaOptions).reduce(function (options, optionName) {\n            options[optionName] = userOptions.cordovaOptions[optionName];\n            return options;\n          }, {});\n        } else {\n          return {};\n        }\n      };\n      var formatCordovaOptions = function (cordovaOptions) {\n        return Object.keys(cordovaOptions).reduce(function (options, optionName) {\n          options.push(optionName + \"=\" + cordovaOptions[optionName]);\n          return options;\n        }, []).join(\",\");\n      };\n      var createCordovaOptions = function (userOptions) {\n        var cordovaOptions = shallowCloneCordovaOptions(userOptions);\n        cordovaOptions.location = 'no';\n        if (userOptions && userOptions.prompt == 'none') {\n          cordovaOptions.hidden = 'yes';\n        }\n        return formatCordovaOptions(cordovaOptions);\n      };\n      var getCordovaRedirectUri = function () {\n        return kc.redirectUri || 'http://localhost';\n      };\n      return {\n        login: async function (options) {\n          var promise = createPromise();\n          var cordovaOptions = createCordovaOptions(options);\n          var loginUrl = await kc.createLoginUrl(options);\n          var ref = cordovaOpenWindowWrapper(loginUrl, '_blank', cordovaOptions);\n          var completed = false;\n          var closed = false;\n          var closeBrowser = function () {\n            closed = true;\n            ref.close();\n          };\n          ref.addEventListener('loadstart', function (event) {\n            if (event.url.indexOf(getCordovaRedirectUri()) == 0) {\n              var callback = parseCallback(event.url);\n              processCallback(callback, promise);\n              closeBrowser();\n              completed = true;\n            }\n          });\n          ref.addEventListener('loaderror', function (event) {\n            if (!completed) {\n              if (event.url.indexOf(getCordovaRedirectUri()) == 0) {\n                var callback = parseCallback(event.url);\n                processCallback(callback, promise);\n                closeBrowser();\n                completed = true;\n              } else {\n                promise.setError();\n                closeBrowser();\n              }\n            }\n          });\n          ref.addEventListener('exit', function (event) {\n            if (!closed) {\n              promise.setError({\n                reason: \"closed_by_user\"\n              });\n            }\n          });\n          return promise.promise;\n        },\n        logout: function (options) {\n          var promise = createPromise();\n          var logoutUrl = kc.createLogoutUrl(options);\n          var ref = cordovaOpenWindowWrapper(logoutUrl, '_blank', 'location=no,hidden=yes,clearcache=yes');\n          var error;\n          ref.addEventListener('loadstart', function (event) {\n            if (event.url.indexOf(getCordovaRedirectUri()) == 0) {\n              ref.close();\n            }\n          });\n          ref.addEventListener('loaderror', function (event) {\n            if (event.url.indexOf(getCordovaRedirectUri()) == 0) {\n              ref.close();\n            } else {\n              error = true;\n              ref.close();\n            }\n          });\n          ref.addEventListener('exit', function (event) {\n            if (error) {\n              promise.setError();\n            } else {\n              kc.clearToken();\n              promise.setSuccess();\n            }\n          });\n          return promise.promise;\n        },\n        register: async function (options) {\n          var promise = createPromise();\n          var registerUrl = await kc.createRegisterUrl();\n          var cordovaOptions = createCordovaOptions(options);\n          var ref = cordovaOpenWindowWrapper(registerUrl, '_blank', cordovaOptions);\n          ref.addEventListener('loadstart', function (event) {\n            if (event.url.indexOf(getCordovaRedirectUri()) == 0) {\n              ref.close();\n              var oauth = parseCallback(event.url);\n              processCallback(oauth, promise);\n            }\n          });\n          return promise.promise;\n        },\n        accountManagement: function () {\n          var accountUrl = kc.createAccountUrl();\n          if (typeof accountUrl !== 'undefined') {\n            var ref = cordovaOpenWindowWrapper(accountUrl, '_blank', 'location=no');\n            ref.addEventListener('loadstart', function (event) {\n              if (event.url.indexOf(getCordovaRedirectUri()) == 0) {\n                ref.close();\n              }\n            });\n          } else {\n            throw \"Not supported by the OIDC server\";\n          }\n        },\n        redirectUri: function (options) {\n          return getCordovaRedirectUri();\n        }\n      };\n    }\n    if (type == 'cordova-native') {\n      loginIframe.enable = false;\n      return {\n        login: async function (options) {\n          var promise = createPromise();\n          var loginUrl = await kc.createLoginUrl(options);\n          universalLinks.subscribe('keycloak', function (event) {\n            universalLinks.unsubscribe('keycloak');\n            window.cordova.plugins.browsertab.close();\n            var oauth = parseCallback(event.url);\n            processCallback(oauth, promise);\n          });\n          window.cordova.plugins.browsertab.openUrl(loginUrl);\n          return promise.promise;\n        },\n        logout: function (options) {\n          var promise = createPromise();\n          var logoutUrl = kc.createLogoutUrl(options);\n          universalLinks.subscribe('keycloak', function (event) {\n            universalLinks.unsubscribe('keycloak');\n            window.cordova.plugins.browsertab.close();\n            kc.clearToken();\n            promise.setSuccess();\n          });\n          window.cordova.plugins.browsertab.openUrl(logoutUrl);\n          return promise.promise;\n        },\n        register: async function (options) {\n          var promise = createPromise();\n          var registerUrl = await kc.createRegisterUrl(options);\n          universalLinks.subscribe('keycloak', function (event) {\n            universalLinks.unsubscribe('keycloak');\n            window.cordova.plugins.browsertab.close();\n            var oauth = parseCallback(event.url);\n            processCallback(oauth, promise);\n          });\n          window.cordova.plugins.browsertab.openUrl(registerUrl);\n          return promise.promise;\n        },\n        accountManagement: function () {\n          var accountUrl = kc.createAccountUrl();\n          if (typeof accountUrl !== 'undefined') {\n            window.cordova.plugins.browsertab.openUrl(accountUrl);\n          } else {\n            throw \"Not supported by the OIDC server\";\n          }\n        },\n        redirectUri: function (options) {\n          if (options && options.redirectUri) {\n            return options.redirectUri;\n          } else if (kc.redirectUri) {\n            return kc.redirectUri;\n          } else {\n            return \"http://localhost\";\n          }\n        }\n      };\n    }\n    throw 'invalid adapter type: ' + type;\n  }\n  const STORAGE_KEY_PREFIX = 'kc-callback-';\n  var LocalStorage = function () {\n    if (!(this instanceof LocalStorage)) {\n      return new LocalStorage();\n    }\n    localStorage.setItem('kc-test', 'test');\n    localStorage.removeItem('kc-test');\n    var cs = this;\n\n    /**\r\n     * Clears all values from local storage that are no longer valid.\r\n     */\n    function clearInvalidValues() {\n      const currentTime = Date.now();\n      for (const [key, value] of getStoredEntries()) {\n        // Attempt to parse the expiry time from the value.\n        const expiry = parseExpiry(value);\n\n        // Discard the value if it is malformed or expired.\n        if (expiry === null || expiry < currentTime) {\n          localStorage.removeItem(key);\n        }\n      }\n    }\n\n    /**\r\n     * Clears all known values from local storage.\r\n     */\n    function clearAllValues() {\n      for (const [key] of getStoredEntries()) {\n        localStorage.removeItem(key);\n      }\n    }\n\n    /**\r\n     * Gets all entries stored in local storage that are known to be managed by this class.\r\n     * @returns {Array<[string, unknown]>} An array of key-value pairs.\r\n     */\n    function getStoredEntries() {\n      return Object.entries(localStorage).filter(([key]) => key.startsWith(STORAGE_KEY_PREFIX));\n    }\n\n    /**\r\n     * Parses the expiry time from a value stored in local storage.\r\n     * @param {unknown} value\r\n     * @returns {number | null} The expiry time in milliseconds, or `null` if the value is malformed.\r\n     */\n    function parseExpiry(value) {\n      let parsedValue;\n\n      // Attempt to parse the value as JSON.\n      try {\n        parsedValue = JSON.parse(value);\n      } catch (error) {\n        return null;\n      }\n\n      // Attempt to extract the 'expires' property.\n      if (isObject(parsedValue) && 'expires' in parsedValue && typeof parsedValue.expires === 'number') {\n        return parsedValue.expires;\n      }\n      return null;\n    }\n    cs.get = function (state) {\n      if (!state) {\n        return;\n      }\n      var key = STORAGE_KEY_PREFIX + state;\n      var value = localStorage.getItem(key);\n      if (value) {\n        localStorage.removeItem(key);\n        value = JSON.parse(value);\n      }\n      clearInvalidValues();\n      return value;\n    };\n    cs.add = function (state) {\n      clearInvalidValues();\n      const key = STORAGE_KEY_PREFIX + state.state;\n      const value = JSON.stringify({\n        ...state,\n        // Set the expiry time to 1 hour from now.\n        expires: Date.now() + 60 * 60 * 1000\n      });\n      try {\n        localStorage.setItem(key, value);\n      } catch (error) {\n        // If the storage is full, clear all known values and try again.\n        clearAllValues();\n        localStorage.setItem(key, value);\n      }\n    };\n  };\n  var CookieStorage = function () {\n    if (!(this instanceof CookieStorage)) {\n      return new CookieStorage();\n    }\n    var cs = this;\n    cs.get = function (state) {\n      if (!state) {\n        return;\n      }\n      var value = getCookie(STORAGE_KEY_PREFIX + state);\n      setCookie(STORAGE_KEY_PREFIX + state, '', cookieExpiration(-100));\n      if (value) {\n        return JSON.parse(value);\n      }\n    };\n    cs.add = function (state) {\n      setCookie(STORAGE_KEY_PREFIX + state.state, JSON.stringify(state), cookieExpiration(60));\n    };\n    cs.removeItem = function (key) {\n      setCookie(key, '', cookieExpiration(-100));\n    };\n    var cookieExpiration = function (minutes) {\n      var exp = new Date();\n      exp.setTime(exp.getTime() + minutes * 60 * 1000);\n      return exp;\n    };\n    var getCookie = function (key) {\n      var name = key + '=';\n      var ca = document.cookie.split(';');\n      for (var i = 0; i < ca.length; i++) {\n        var c = ca[i];\n        while (c.charAt(0) == ' ') {\n          c = c.substring(1);\n        }\n        if (c.indexOf(name) == 0) {\n          return c.substring(name.length, c.length);\n        }\n      }\n      return '';\n    };\n    var setCookie = function (key, value, expirationDate) {\n      var cookie = key + '=' + value + '; ' + 'expires=' + expirationDate.toUTCString() + '; ';\n      document.cookie = cookie;\n    };\n  };\n  function createCallbackStorage() {\n    try {\n      return new LocalStorage();\n    } catch (err) {}\n    return new CookieStorage();\n  }\n  function createLogger(fn) {\n    return function () {\n      if (kc.enableLogging) {\n        fn.apply(console, Array.prototype.slice.call(arguments));\n      }\n    };\n  }\n}\nexport default Keycloak;\n\n/**\r\n * @param {ArrayBuffer} bytes\r\n * @see https://developer.mozilla.org/en-US/docs/Glossary/Base64#the_unicode_problem\r\n */\nfunction bytesToBase64(bytes) {\n  const binString = String.fromCodePoint(...bytes);\n  return btoa(binString);\n}\n\n/**\r\n * @param {string} message\r\n * @see https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/digest#basic_example\r\n */\nasync function sha256Digest(message) {\n  const encoder = new TextEncoder();\n  const data = encoder.encode(message);\n  if (typeof crypto === \"undefined\" || typeof crypto.subtle === \"undefined\") {\n    throw new Error(\"Web Crypto API is not available.\");\n  }\n  return await crypto.subtle.digest(\"SHA-256\", data);\n}\n\n/**\r\n * @param {string} token\r\n */\nfunction decodeToken(token) {\n  const [header, payload] = token.split(\".\");\n  if (typeof payload !== \"string\") {\n    throw new Error(\"Unable to decode token, payload not found.\");\n  }\n  let decoded;\n  try {\n    decoded = base64UrlDecode(payload);\n  } catch (error) {\n    throw new Error(\"Unable to decode token, payload is not a valid Base64URL value.\", {\n      cause: error\n    });\n  }\n  try {\n    return JSON.parse(decoded);\n  } catch (error) {\n    throw new Error(\"Unable to decode token, payload is not a valid JSON value.\", {\n      cause: error\n    });\n  }\n}\n\n/**\r\n * @param {string} input\r\n */\nfunction base64UrlDecode(input) {\n  let output = input.replaceAll(\"-\", \"+\").replaceAll(\"_\", \"/\");\n  switch (output.length % 4) {\n    case 0:\n      break;\n    case 2:\n      output += \"==\";\n      break;\n    case 3:\n      output += \"=\";\n      break;\n    default:\n      throw new Error(\"Input is not of the correct length.\");\n  }\n  try {\n    return b64DecodeUnicode(output);\n  } catch (error) {\n    return atob(output);\n  }\n}\n\n/**\r\n * @param {string} input\r\n */\nfunction b64DecodeUnicode(input) {\n  return decodeURIComponent(atob(input).replace(/(.)/g, (m, p) => {\n    let code = p.charCodeAt(0).toString(16).toUpperCase();\n    if (code.length < 2) {\n      code = \"0\" + code;\n    }\n    return \"%\" + code;\n  }));\n}\n\n/**\r\n * Check if the input is an object that can be operated on.\r\n * @param {unknown} input\r\n */\nfunction isObject(input) {\n  return typeof input === 'object' && input !== null;\n}","map":{"version":3,"names":["Keycloak","config","Error","isObject","requiredProperties","property","kc","adapter","refreshQueue","callbackStorage","loginIframe","enable","callbackList","interval","didInitialize","useNonce","logInfo","createLogger","console","info","logWarn","warn","globalThis","isSecureContext","init","initOptions","authenticated","createCallbackStorage","adapters","indexOf","loadAdapter","window","Cordova","cordova","checkLoginIframe","checkLoginIframeInterval","onLoad","loginRequired","responseMode","flow","responseType","timeSkew","redirectUri","silentCheckSsoRedirectUri","silentCheckSsoFallback","pkceMethod","TypeError","enableLogging","logoutMethod","scope","acrValues","messageReceiveTimeout","promise","createPromise","initPromise","then","onReady","setSuccess","catch","error","setError","configPromise","loadConfig","doLogin","prompt","options","locale","login","checkSsoSilently","ifrm","document","createElement","src","createLoginUrl","setAttribute","style","display","body","appendChild","messageCallback","event","origin","location","contentWindow","source","oauth","parseCallback","data","processCallback","removeChild","removeEventListener","addEventListener","setupCheckLoginIframe","unchanged","processInit","callback","href","history","replaceState","state","newUrl","valid","token","refreshToken","setToken","idToken","onAuthSuccess","scheduleCheckIframe","updateToken","onAuthError","check3pCookiesSupported","generateRandomData","len","crypto","getRandomValues","Uint8Array","generateCodeVerifier","generateRandomString","alphabet","randomData","chars","Array","i","charCodeAt","length","String","fromCharCode","apply","generatePkceChallenge","codeVerifier","hashBytes","sha256Digest","encodedHash","bytesToBase64","replace","buildClaimsParameter","requestedAcr","claims","id_token","acr","JSON","stringify","createUUID","nonce","callbackState","encodeURIComponent","loginOptions","baseUrl","action","endpoints","register","authorize","url","clientId","maxAge","loginHint","idpHint","claimsParameter","pkceChallenge","pkceCodeVerifier","cause","add","logout","createLogoutUrl","createRegisterUrl","createAccountUrl","realm","getRealmUrl","undefined","accountManagement","hasRealmRole","role","access","realmAccess","roles","hasResourceRole","resource","resourceAccess","loadUserProfile","req","XMLHttpRequest","open","setRequestHeader","onreadystatechange","readyState","status","profile","parse","responseText","send","loadUserInfo","userinfo","userInfo","isTokenExpired","minValidity","tokenParsed","expiresIn","Math","ceil","Date","getTime","isNaN","exec","params","push","withCredentials","timeLocal","tokenResponse","onAuthRefreshSuccess","p","pop","clearToken","onAuthRefreshError","iframePromise","onAuthLogout","authServerUrl","charAt","getOrigin","protocol","hostname","port","code","onActionUpdate","error_description","errorData","access_token","authSuccess","accessToken","fulfillPromise","idTokenParsed","storedNonce","configUrl","setupOidcEndoints","oidcConfiguration","checkSessionIframe","thirdPartyCookiesIframe","authorization_endpoint","token_endpoint","end_session_endpoint","check_session_iframe","userinfo_endpoint","fileLoaded","oidcProvider","oidcProviderConfigUrl","oidcProviderConfig","xhr","responseURL","startsWith","tokenTimeoutHandle","clearTimeout","refreshTokenParsed","decodeToken","sessionId","sid","subject","sub","realm_access","resource_access","floor","iat","onTokenExpired","round","setTimeout","randomUUID","parseCallbackUrl","oauthState","get","supportedParams","queryIndex","fragmentIndex","parsed","substring","parseCallbackParams","paramsString","oauthParams","split","result","key","slice","resolve","reject","Promise","applyTimeoutToPromise","timeout","errorMessage","timeoutHandle","timeoutPromise","race","finally","iframe","onload","authUrl","iframeOrigin","callbacks","splice","msg","postMessage","type","assign","logoutUrl","response","fetch","method","headers","URLSearchParams","id_token_hint","client_id","post_logout_redirect_uri","redirected","ok","reload","accountUrl","encodeHash","arguments","cordovaOpenWindowWrapper","loginUrl","target","InAppBrowser","shallowCloneCordovaOptions","userOptions","cordovaOptions","Object","keys","reduce","optionName","formatCordovaOptions","join","createCordovaOptions","hidden","getCordovaRedirectUri","ref","completed","closed","closeBrowser","close","reason","registerUrl","universalLinks","subscribe","unsubscribe","plugins","browsertab","openUrl","STORAGE_KEY_PREFIX","LocalStorage","localStorage","setItem","removeItem","cs","clearInvalidValues","currentTime","now","value","getStoredEntries","expiry","parseExpiry","clearAllValues","entries","filter","parsedValue","expires","getItem","CookieStorage","getCookie","setCookie","cookieExpiration","minutes","exp","setTime","name","ca","cookie","c","expirationDate","toUTCString","err","fn","prototype","call","bytes","binString","fromCodePoint","btoa","message","encoder","TextEncoder","encode","subtle","digest","header","payload","decoded","base64UrlDecode","input","output","replaceAll","b64DecodeUnicode","atob","decodeURIComponent","m","toString","toUpperCase"],"sources":["C:/Users/student/Desktop/WebBee/Hack_Webbi/web-bee-app/client/node_modules/keycloak-js/lib/keycloak.js"],"sourcesContent":["/*\r\n * Copyright 2016 Red Hat, Inc. and/or its affiliates\r\n * and other contributors as indicated by the @author tags.\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n * http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */\r\nfunction Keycloak (config) {\r\n    if (!(this instanceof Keycloak)) {\r\n        throw new Error(\"The 'Keycloak' constructor must be invoked with 'new'.\")\r\n    }\r\n\r\n    if (typeof config !== 'string' && !isObject(config)) {\r\n        throw new Error(\"The 'Keycloak' constructor must be provided with a configuration object, or a URL to a JSON configuration file.\");\r\n    }\r\n\r\n    if (isObject(config)) {\r\n        const requiredProperties = 'oidcProvider' in config\r\n            ? ['clientId']\r\n            : ['url', 'realm', 'clientId'];\r\n\r\n        for (const property of requiredProperties) {\r\n            if (!config[property]) {\r\n                throw new Error(`The configuration object is missing the required '${property}' property.`);\r\n            }\r\n        }\r\n    }\r\n\r\n    var kc = this;\r\n    var adapter;\r\n    var refreshQueue = [];\r\n    var callbackStorage;\r\n\r\n    var loginIframe = {\r\n        enable: true,\r\n        callbackList: [],\r\n        interval: 5\r\n    };\r\n\r\n    kc.didInitialize = false;\r\n\r\n    var useNonce = true;\r\n    var logInfo = createLogger(console.info);\r\n    var logWarn = createLogger(console.warn);\r\n\r\n    if (!globalThis.isSecureContext) {\r\n        logWarn(\r\n            \"[KEYCLOAK] Keycloak JS must be used in a 'secure context' to function properly as it relies on browser APIs that are otherwise not available.\\n\" +\r\n            \"Continuing to run your application insecurely will lead to unexpected behavior and breakage.\\n\\n\" +\r\n            \"For more information see: https://developer.mozilla.org/en-US/docs/Web/Security/Secure_Contexts\"\r\n        );\r\n    }\r\n\r\n    kc.init = function (initOptions = {}) {\r\n        if (kc.didInitialize) {\r\n            throw new Error(\"A 'Keycloak' instance can only be initialized once.\");\r\n        }\r\n\r\n        kc.didInitialize = true;\r\n\r\n        kc.authenticated = false;\r\n\r\n        callbackStorage = createCallbackStorage();\r\n        var adapters = ['default', 'cordova', 'cordova-native'];\r\n\r\n        if (adapters.indexOf(initOptions.adapter) > -1) {\r\n            adapter = loadAdapter(initOptions.adapter);\r\n        } else if (typeof initOptions.adapter === \"object\") {\r\n            adapter = initOptions.adapter;\r\n        } else {\r\n            if (window.Cordova || window.cordova) {\r\n                adapter = loadAdapter('cordova');\r\n            } else {\r\n                adapter = loadAdapter();\r\n            }\r\n        }\r\n\r\n        if (typeof initOptions.useNonce !== 'undefined') {\r\n            useNonce = initOptions.useNonce;\r\n        }\r\n\r\n        if (typeof initOptions.checkLoginIframe !== 'undefined') {\r\n            loginIframe.enable = initOptions.checkLoginIframe;\r\n        }\r\n\r\n        if (initOptions.checkLoginIframeInterval) {\r\n            loginIframe.interval = initOptions.checkLoginIframeInterval;\r\n        }\r\n\r\n        if (initOptions.onLoad === 'login-required') {\r\n            kc.loginRequired = true;\r\n        }\r\n\r\n        if (initOptions.responseMode) {\r\n            if (initOptions.responseMode === 'query' || initOptions.responseMode === 'fragment') {\r\n                kc.responseMode = initOptions.responseMode;\r\n            } else {\r\n                throw 'Invalid value for responseMode';\r\n            }\r\n        }\r\n\r\n        if (initOptions.flow) {\r\n            switch (initOptions.flow) {\r\n                case 'standard':\r\n                    kc.responseType = 'code';\r\n                    break;\r\n                case 'implicit':\r\n                    kc.responseType = 'id_token token';\r\n                    break;\r\n                case 'hybrid':\r\n                    kc.responseType = 'code id_token token';\r\n                    break;\r\n                default:\r\n                    throw 'Invalid value for flow';\r\n            }\r\n            kc.flow = initOptions.flow;\r\n        }\r\n\r\n        if (initOptions.timeSkew != null) {\r\n            kc.timeSkew = initOptions.timeSkew;\r\n        }\r\n\r\n        if(initOptions.redirectUri) {\r\n            kc.redirectUri = initOptions.redirectUri;\r\n        }\r\n\r\n        if (initOptions.silentCheckSsoRedirectUri) {\r\n            kc.silentCheckSsoRedirectUri = initOptions.silentCheckSsoRedirectUri;\r\n        }\r\n\r\n        if (typeof initOptions.silentCheckSsoFallback === 'boolean') {\r\n            kc.silentCheckSsoFallback = initOptions.silentCheckSsoFallback;\r\n        } else {\r\n            kc.silentCheckSsoFallback = true;\r\n        }\r\n\r\n        if (typeof initOptions.pkceMethod !== \"undefined\") {\r\n            if (initOptions.pkceMethod !== \"S256\" && initOptions.pkceMethod !== false) {\r\n                throw new TypeError(`Invalid value for pkceMethod', expected 'S256' or false but got ${initOptions.pkceMethod}.`);\r\n            }\r\n\r\n            kc.pkceMethod = initOptions.pkceMethod;\r\n        } else {\r\n            kc.pkceMethod = \"S256\";\r\n        }\r\n\r\n        if (typeof initOptions.enableLogging === 'boolean') {\r\n            kc.enableLogging = initOptions.enableLogging;\r\n        } else {\r\n            kc.enableLogging = false;\r\n        }\r\n\r\n        if (initOptions.logoutMethod === 'POST') {\r\n            kc.logoutMethod = 'POST';\r\n        } else {\r\n            kc.logoutMethod = 'GET';\r\n        }\r\n\r\n        if (typeof initOptions.scope === 'string') {\r\n            kc.scope = initOptions.scope;\r\n        }\r\n\r\n        if (typeof initOptions.acrValues === 'string') {\r\n            kc.acrValues = initOptions.acrValues;\r\n        }\r\n\r\n        if (typeof initOptions.messageReceiveTimeout === 'number' && initOptions.messageReceiveTimeout > 0) {\r\n            kc.messageReceiveTimeout = initOptions.messageReceiveTimeout;\r\n        } else {\r\n            kc.messageReceiveTimeout = 10000;\r\n        }\r\n\r\n        if (!kc.responseMode) {\r\n            kc.responseMode = 'fragment';\r\n        }\r\n        if (!kc.responseType) {\r\n            kc.responseType = 'code';\r\n            kc.flow = 'standard';\r\n        }\r\n\r\n        var promise = createPromise();\r\n\r\n        var initPromise = createPromise();\r\n        initPromise.promise.then(function() {\r\n            kc.onReady && kc.onReady(kc.authenticated);\r\n            promise.setSuccess(kc.authenticated);\r\n        }).catch(function(error) {\r\n            promise.setError(error);\r\n        });\r\n\r\n        var configPromise = loadConfig();\r\n\r\n        function onLoad() {\r\n            var doLogin = function(prompt) {\r\n                if (!prompt) {\r\n                    options.prompt = 'none';\r\n                }\r\n\r\n                if (initOptions.locale) {\r\n                    options.locale = initOptions.locale;\r\n                }\r\n                kc.login(options).then(function () {\r\n                    initPromise.setSuccess();\r\n                }).catch(function (error) {\r\n                    initPromise.setError(error);\r\n                });\r\n            }\r\n\r\n            var checkSsoSilently = async function() {\r\n                var ifrm = document.createElement(\"iframe\");\r\n                var src = await kc.createLoginUrl({prompt: 'none', redirectUri: kc.silentCheckSsoRedirectUri});\r\n                ifrm.setAttribute(\"src\", src);\r\n                ifrm.setAttribute(\"sandbox\", \"allow-storage-access-by-user-activation allow-scripts allow-same-origin\");\r\n                ifrm.setAttribute(\"title\", \"keycloak-silent-check-sso\");\r\n                ifrm.style.display = \"none\";\r\n                document.body.appendChild(ifrm);\r\n\r\n                var messageCallback = function(event) {\r\n                    if (event.origin !== window.location.origin || ifrm.contentWindow !== event.source) {\r\n                        return;\r\n                    }\r\n\r\n                    var oauth = parseCallback(event.data);\r\n                    processCallback(oauth, initPromise);\r\n\r\n                    document.body.removeChild(ifrm);\r\n                    window.removeEventListener(\"message\", messageCallback);\r\n                };\r\n\r\n                window.addEventListener(\"message\", messageCallback);\r\n            };\r\n\r\n            var options = {};\r\n            switch (initOptions.onLoad) {\r\n                case 'check-sso':\r\n                    if (loginIframe.enable) {\r\n                        setupCheckLoginIframe().then(function() {\r\n                            checkLoginIframe().then(function (unchanged) {\r\n                                if (!unchanged) {\r\n                                    kc.silentCheckSsoRedirectUri ? checkSsoSilently() : doLogin(false);\r\n                                } else {\r\n                                    initPromise.setSuccess();\r\n                                }\r\n                            }).catch(function (error) {\r\n                                initPromise.setError(error);\r\n                            });\r\n                        });\r\n                    } else {\r\n                        kc.silentCheckSsoRedirectUri ? checkSsoSilently() : doLogin(false);\r\n                    }\r\n                    break;\r\n                case 'login-required':\r\n                    doLogin(true);\r\n                    break;\r\n                default:\r\n                    throw 'Invalid value for onLoad';\r\n            }\r\n        }\r\n\r\n        function processInit() {\r\n            var callback = parseCallback(window.location.href);\r\n\r\n            if (callback) {\r\n                window.history.replaceState(window.history.state, null, callback.newUrl);\r\n            }\r\n\r\n            if (callback && callback.valid) {\r\n                return setupCheckLoginIframe().then(function() {\r\n                    processCallback(callback, initPromise);\r\n                }).catch(function (error) {\r\n                    initPromise.setError(error);\r\n                });\r\n            }\r\n\r\n            if (initOptions.token && initOptions.refreshToken) {\r\n                setToken(initOptions.token, initOptions.refreshToken, initOptions.idToken);\r\n\r\n                if (loginIframe.enable) {\r\n                    setupCheckLoginIframe().then(function() {\r\n                        checkLoginIframe().then(function (unchanged) {\r\n                            if (unchanged) {\r\n                                kc.onAuthSuccess && kc.onAuthSuccess();\r\n                                initPromise.setSuccess();\r\n                                scheduleCheckIframe();\r\n                            } else {\r\n                                initPromise.setSuccess();\r\n                            }\r\n                        }).catch(function (error) {\r\n                            initPromise.setError(error);\r\n                        });\r\n                    });\r\n                } else {\r\n                    kc.updateToken(-1).then(function() {\r\n                        kc.onAuthSuccess && kc.onAuthSuccess();\r\n                        initPromise.setSuccess();\r\n                    }).catch(function(error) {\r\n                        kc.onAuthError && kc.onAuthError();\r\n                        if (initOptions.onLoad) {\r\n                            onLoad();\r\n                        } else {\r\n                            initPromise.setError(error);\r\n                        }\r\n                    });\r\n                }\r\n            } else if (initOptions.onLoad) {\r\n                onLoad();\r\n            } else {\r\n                initPromise.setSuccess();\r\n            }\r\n        }\r\n\r\n        configPromise.then(function () {\r\n            check3pCookiesSupported()\r\n                .then(processInit)\r\n                .catch(function (error) {\r\n                    promise.setError(error);\r\n                });\r\n        });\r\n        configPromise.catch(function (error) {\r\n            promise.setError(error);\r\n        });\r\n\r\n        return promise.promise;\r\n    }\r\n\r\n    kc.login = function (options) {\r\n        return adapter.login(options);\r\n    }\r\n\r\n    function generateRandomData(len) {\r\n        if (typeof crypto === \"undefined\" || typeof crypto.getRandomValues === \"undefined\") {\r\n            throw new Error(\"Web Crypto API is not available.\");\r\n        }\r\n\r\n        return crypto.getRandomValues(new Uint8Array(len));\r\n    }\r\n\r\n    function generateCodeVerifier(len) {\r\n        return generateRandomString(len, 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789');\r\n    }\r\n\r\n    function generateRandomString(len, alphabet){\r\n        var randomData = generateRandomData(len);\r\n        var chars = new Array(len);\r\n        for (var i = 0; i < len; i++) {\r\n            chars[i] = alphabet.charCodeAt(randomData[i] % alphabet.length);\r\n        }\r\n        return String.fromCharCode.apply(null, chars);\r\n    }\r\n\r\n    async function generatePkceChallenge(pkceMethod, codeVerifier) {\r\n        if (pkceMethod !== \"S256\") {\r\n            throw new TypeError(`Invalid value for 'pkceMethod', expected 'S256' but got '${pkceMethod}'.`);\r\n        }\r\n\r\n        // hash codeVerifier, then encode as url-safe base64 without padding\r\n        const hashBytes = new Uint8Array(await sha256Digest(codeVerifier));\r\n        const encodedHash = bytesToBase64(hashBytes)\r\n            .replace(/\\+/g, '-')\r\n            .replace(/\\//g, '_')\r\n            .replace(/\\=/g, '');\r\n\r\n        return encodedHash;\r\n    }\r\n\r\n    function buildClaimsParameter(requestedAcr){\r\n        var claims = {\r\n            id_token: {\r\n                acr: requestedAcr\r\n            }\r\n        }\r\n        return JSON.stringify(claims);\r\n    }\r\n\r\n    kc.createLoginUrl = async function(options) {\r\n        var state = createUUID();\r\n        var nonce = createUUID();\r\n\r\n        var redirectUri = adapter.redirectUri(options);\r\n\r\n        var callbackState = {\r\n            state: state,\r\n            nonce: nonce,\r\n            redirectUri: encodeURIComponent(redirectUri),\r\n            loginOptions: options\r\n        };\r\n\r\n        if (options && options.prompt) {\r\n            callbackState.prompt = options.prompt;\r\n        }\r\n\r\n        var baseUrl;\r\n        if (options && options.action == 'register') {\r\n            baseUrl = kc.endpoints.register();\r\n        } else {\r\n            baseUrl = kc.endpoints.authorize();\r\n        }\r\n\r\n        var scope = options && options.scope || kc.scope;\r\n        if (!scope) {\r\n            // if scope is not set, default to \"openid\"\r\n            scope = \"openid\";\r\n        } else if (scope.indexOf(\"openid\") === -1) {\r\n            // if openid scope is missing, prefix the given scopes with it\r\n            scope = \"openid \" + scope;\r\n        }\r\n\r\n        var url = baseUrl\r\n            + '?client_id=' + encodeURIComponent(kc.clientId)\r\n            + '&redirect_uri=' + encodeURIComponent(redirectUri)\r\n            + '&state=' + encodeURIComponent(state)\r\n            + '&response_mode=' + encodeURIComponent(kc.responseMode)\r\n            + '&response_type=' + encodeURIComponent(kc.responseType)\r\n            + '&scope=' + encodeURIComponent(scope);\r\n        if (useNonce) {\r\n            url = url + '&nonce=' + encodeURIComponent(nonce);\r\n        }\r\n\r\n        if (options && options.prompt) {\r\n            url += '&prompt=' + encodeURIComponent(options.prompt);\r\n        }\r\n\r\n        if (options && typeof options.maxAge === 'number') {\r\n            url += '&max_age=' + encodeURIComponent(options.maxAge);\r\n        }\r\n\r\n        if (options && options.loginHint) {\r\n            url += '&login_hint=' + encodeURIComponent(options.loginHint);\r\n        }\r\n\r\n        if (options && options.idpHint) {\r\n            url += '&kc_idp_hint=' + encodeURIComponent(options.idpHint);\r\n        }\r\n\r\n        if (options && options.action && options.action != 'register') {\r\n            url += '&kc_action=' + encodeURIComponent(options.action);\r\n        }\r\n\r\n        if (options && options.locale) {\r\n            url += '&ui_locales=' + encodeURIComponent(options.locale);\r\n        }\r\n\r\n        if (options && options.acr) {\r\n            var claimsParameter = buildClaimsParameter(options.acr);\r\n            url += '&claims=' + encodeURIComponent(claimsParameter);\r\n        }\r\n\r\n        if ((options && options.acrValues) || kc.acrValues) {\r\n            url += '&acr_values=' + encodeURIComponent(options.acrValues || kc.acrValues);\r\n        }\r\n\r\n        if (kc.pkceMethod) {\r\n            try {\r\n                const codeVerifier = generateCodeVerifier(96);\r\n                const pkceChallenge = await generatePkceChallenge(kc.pkceMethod, codeVerifier);\r\n\r\n                callbackState.pkceCodeVerifier = codeVerifier;\r\n\r\n                url += '&code_challenge=' + pkceChallenge;\r\n                url += '&code_challenge_method=' + kc.pkceMethod;\r\n            } catch (error) {\r\n                throw new Error(\"Failed to generate PKCE challenge.\", { cause: error });\r\n            }\r\n        }\r\n\r\n        callbackStorage.add(callbackState);\r\n\r\n        return url;\r\n    }\r\n\r\n    kc.logout = function(options) {\r\n        return adapter.logout(options);\r\n    }\r\n\r\n    kc.createLogoutUrl = function(options) {\r\n\r\n        const logoutMethod = options?.logoutMethod ?? kc.logoutMethod;\r\n        if (logoutMethod === 'POST') {\r\n            return kc.endpoints.logout();\r\n        }\r\n\r\n        var url = kc.endpoints.logout()\r\n            + '?client_id=' + encodeURIComponent(kc.clientId)\r\n            + '&post_logout_redirect_uri=' + encodeURIComponent(adapter.redirectUri(options, false));\r\n\r\n        if (kc.idToken) {\r\n            url += '&id_token_hint=' + encodeURIComponent(kc.idToken);\r\n        }\r\n\r\n        return url;\r\n    }\r\n\r\n    kc.register = function (options) {\r\n        return adapter.register(options);\r\n    }\r\n\r\n    kc.createRegisterUrl = async function(options) {\r\n        if (!options) {\r\n            options = {};\r\n        }\r\n        options.action = 'register';\r\n        return await kc.createLoginUrl(options);\r\n    }\r\n\r\n    kc.createAccountUrl = function(options) {\r\n        var realm = getRealmUrl();\r\n        var url = undefined;\r\n        if (typeof realm !== 'undefined') {\r\n            url = realm\r\n            + '/account'\r\n            + '?referrer=' + encodeURIComponent(kc.clientId)\r\n            + '&referrer_uri=' + encodeURIComponent(adapter.redirectUri(options));\r\n        }\r\n        return url;\r\n    }\r\n\r\n    kc.accountManagement = function() {\r\n        return adapter.accountManagement();\r\n    }\r\n\r\n    kc.hasRealmRole = function (role) {\r\n        var access = kc.realmAccess;\r\n        return !!access && access.roles.indexOf(role) >= 0;\r\n    }\r\n\r\n    kc.hasResourceRole = function(role, resource) {\r\n        if (!kc.resourceAccess) {\r\n            return false;\r\n        }\r\n\r\n        var access = kc.resourceAccess[resource || kc.clientId];\r\n        return !!access && access.roles.indexOf(role) >= 0;\r\n    }\r\n\r\n    kc.loadUserProfile = function() {\r\n        var url = getRealmUrl() + '/account';\r\n        var req = new XMLHttpRequest();\r\n        req.open('GET', url, true);\r\n        req.setRequestHeader('Accept', 'application/json');\r\n        req.setRequestHeader('Authorization', 'bearer ' + kc.token);\r\n\r\n        var promise = createPromise();\r\n\r\n        req.onreadystatechange = function () {\r\n            if (req.readyState == 4) {\r\n                if (req.status == 200) {\r\n                    kc.profile = JSON.parse(req.responseText);\r\n                    promise.setSuccess(kc.profile);\r\n                } else {\r\n                    promise.setError();\r\n                }\r\n            }\r\n        }\r\n\r\n        req.send();\r\n\r\n        return promise.promise;\r\n    }\r\n\r\n    kc.loadUserInfo = function() {\r\n        var url = kc.endpoints.userinfo();\r\n        var req = new XMLHttpRequest();\r\n        req.open('GET', url, true);\r\n        req.setRequestHeader('Accept', 'application/json');\r\n        req.setRequestHeader('Authorization', 'bearer ' + kc.token);\r\n\r\n        var promise = createPromise();\r\n\r\n        req.onreadystatechange = function () {\r\n            if (req.readyState == 4) {\r\n                if (req.status == 200) {\r\n                    kc.userInfo = JSON.parse(req.responseText);\r\n                    promise.setSuccess(kc.userInfo);\r\n                } else {\r\n                    promise.setError();\r\n                }\r\n            }\r\n        }\r\n\r\n        req.send();\r\n\r\n        return promise.promise;\r\n    }\r\n\r\n    kc.isTokenExpired = function(minValidity) {\r\n        if (!kc.tokenParsed || (!kc.refreshToken && kc.flow != 'implicit' )) {\r\n            throw 'Not authenticated';\r\n        }\r\n\r\n        if (kc.timeSkew == null) {\r\n            logInfo('[KEYCLOAK] Unable to determine if token is expired as timeskew is not set');\r\n            return true;\r\n        }\r\n\r\n        var expiresIn = kc.tokenParsed['exp'] - Math.ceil(new Date().getTime() / 1000) + kc.timeSkew;\r\n        if (minValidity) {\r\n            if (isNaN(minValidity)) {\r\n                throw 'Invalid minValidity';\r\n            }\r\n            expiresIn -= minValidity;\r\n        }\r\n        return expiresIn < 0;\r\n    }\r\n\r\n    kc.updateToken = function(minValidity) {\r\n        var promise = createPromise();\r\n\r\n        if (!kc.refreshToken) {\r\n            promise.setError();\r\n            return promise.promise;\r\n        }\r\n\r\n        minValidity = minValidity || 5;\r\n\r\n        var exec = function() {\r\n            var refreshToken = false;\r\n            if (minValidity == -1) {\r\n                refreshToken = true;\r\n                logInfo('[KEYCLOAK] Refreshing token: forced refresh');\r\n            } else if (!kc.tokenParsed || kc.isTokenExpired(minValidity)) {\r\n                refreshToken = true;\r\n                logInfo('[KEYCLOAK] Refreshing token: token expired');\r\n            }\r\n\r\n            if (!refreshToken) {\r\n                promise.setSuccess(false);\r\n            } else {\r\n                var params = 'grant_type=refresh_token&' + 'refresh_token=' + kc.refreshToken;\r\n                var url = kc.endpoints.token();\r\n\r\n                refreshQueue.push(promise);\r\n\r\n                if (refreshQueue.length == 1) {\r\n                    var req = new XMLHttpRequest();\r\n                    req.open('POST', url, true);\r\n                    req.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');\r\n                    req.withCredentials = true;\r\n\r\n                    params += '&client_id=' + encodeURIComponent(kc.clientId);\r\n\r\n                    var timeLocal = new Date().getTime();\r\n\r\n                    req.onreadystatechange = function () {\r\n                        if (req.readyState == 4) {\r\n                            if (req.status == 200) {\r\n                                logInfo('[KEYCLOAK] Token refreshed');\r\n\r\n                                timeLocal = (timeLocal + new Date().getTime()) / 2;\r\n\r\n                                var tokenResponse = JSON.parse(req.responseText);\r\n\r\n                                setToken(tokenResponse['access_token'], tokenResponse['refresh_token'], tokenResponse['id_token'], timeLocal);\r\n\r\n                                kc.onAuthRefreshSuccess && kc.onAuthRefreshSuccess();\r\n                                for (var p = refreshQueue.pop(); p != null; p = refreshQueue.pop()) {\r\n                                    p.setSuccess(true);\r\n                                }\r\n                            } else {\r\n                                logWarn('[KEYCLOAK] Failed to refresh token');\r\n\r\n                                if (req.status == 400) {\r\n                                    kc.clearToken();\r\n                                }\r\n\r\n                                kc.onAuthRefreshError && kc.onAuthRefreshError();\r\n                                for (var p = refreshQueue.pop(); p != null; p = refreshQueue.pop()) {\r\n                                    p.setError(true);\r\n                                }\r\n                            }\r\n                        }\r\n                    };\r\n\r\n                    req.send(params);\r\n                }\r\n            }\r\n        }\r\n\r\n        if (loginIframe.enable) {\r\n            var iframePromise = checkLoginIframe();\r\n            iframePromise.then(function() {\r\n                exec();\r\n            }).catch(function(error) {\r\n                promise.setError(error);\r\n            });\r\n        } else {\r\n            exec();\r\n        }\r\n\r\n        return promise.promise;\r\n    }\r\n\r\n    kc.clearToken = function() {\r\n        if (kc.token) {\r\n            setToken(null, null, null);\r\n            kc.onAuthLogout && kc.onAuthLogout();\r\n            if (kc.loginRequired) {\r\n                kc.login();\r\n            }\r\n        }\r\n    }\r\n\r\n    function getRealmUrl() {\r\n        if (typeof kc.authServerUrl !== 'undefined') {\r\n            if (kc.authServerUrl.charAt(kc.authServerUrl.length - 1) == '/') {\r\n                return kc.authServerUrl + 'realms/' + encodeURIComponent(kc.realm);\r\n            } else {\r\n                return kc.authServerUrl + '/realms/' + encodeURIComponent(kc.realm);\r\n            }\r\n        } else {\r\n            return undefined;\r\n        }\r\n    }\r\n\r\n    function getOrigin() {\r\n        if (!window.location.origin) {\r\n            return window.location.protocol + \"//\" + window.location.hostname + (window.location.port ? ':' + window.location.port: '');\r\n        } else {\r\n            return window.location.origin;\r\n        }\r\n    }\r\n\r\n    function processCallback(oauth, promise) {\r\n        var code = oauth.code;\r\n        var error = oauth.error;\r\n        var prompt = oauth.prompt;\r\n\r\n        var timeLocal = new Date().getTime();\r\n\r\n        if (oauth['kc_action_status']) {\r\n            kc.onActionUpdate && kc.onActionUpdate(oauth['kc_action_status'], oauth['kc_action']);\r\n        }\r\n\r\n        if (error) {\r\n            if (prompt != 'none') {\r\n                if (oauth.error_description && oauth.error_description === \"authentication_expired\") {\r\n                    kc.login(oauth.loginOptions);\r\n                } else {\r\n                    var errorData = { error: error, error_description: oauth.error_description };\r\n                    kc.onAuthError && kc.onAuthError(errorData);\r\n                    promise && promise.setError(errorData);\r\n                }\r\n            } else {\r\n                promise && promise.setSuccess();\r\n            }\r\n            return;\r\n        } else if ((kc.flow != 'standard') && (oauth.access_token || oauth.id_token)) {\r\n            authSuccess(oauth.access_token, null, oauth.id_token, true);\r\n        }\r\n\r\n        if ((kc.flow != 'implicit') && code) {\r\n            var params = 'code=' + code + '&grant_type=authorization_code';\r\n            var url = kc.endpoints.token();\r\n\r\n            var req = new XMLHttpRequest();\r\n            req.open('POST', url, true);\r\n            req.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');\r\n\r\n            params += '&client_id=' + encodeURIComponent(kc.clientId);\r\n            params += '&redirect_uri=' + oauth.redirectUri;\r\n\r\n            if (oauth.pkceCodeVerifier) {\r\n                params += '&code_verifier=' + oauth.pkceCodeVerifier;\r\n            }\r\n\r\n            req.withCredentials = true;\r\n\r\n            req.onreadystatechange = function() {\r\n                if (req.readyState == 4) {\r\n                    if (req.status == 200) {\r\n\r\n                        var tokenResponse = JSON.parse(req.responseText);\r\n                        authSuccess(tokenResponse['access_token'], tokenResponse['refresh_token'], tokenResponse['id_token'], kc.flow === 'standard');\r\n                        scheduleCheckIframe();\r\n                    } else {\r\n                        kc.onAuthError && kc.onAuthError();\r\n                        promise && promise.setError();\r\n                    }\r\n                }\r\n            };\r\n\r\n            req.send(params);\r\n        }\r\n\r\n        function authSuccess(accessToken, refreshToken, idToken, fulfillPromise) {\r\n            timeLocal = (timeLocal + new Date().getTime()) / 2;\r\n\r\n            setToken(accessToken, refreshToken, idToken, timeLocal);\r\n\r\n            if (useNonce && (kc.idTokenParsed && kc.idTokenParsed.nonce != oauth.storedNonce)) {\r\n                logInfo('[KEYCLOAK] Invalid nonce, clearing token');\r\n                kc.clearToken();\r\n                promise && promise.setError();\r\n            } else {\r\n                if (fulfillPromise) {\r\n                    kc.onAuthSuccess && kc.onAuthSuccess();\r\n                    promise && promise.setSuccess();\r\n                }\r\n            }\r\n        }\r\n\r\n    }\r\n\r\n    function loadConfig() {\r\n        var promise = createPromise();\r\n        var configUrl;\r\n\r\n        if (typeof config === 'string') {\r\n            configUrl = config;\r\n        }\r\n\r\n        function setupOidcEndoints(oidcConfiguration) {\r\n            if (! oidcConfiguration) {\r\n                kc.endpoints = {\r\n                    authorize: function() {\r\n                        return getRealmUrl() + '/protocol/openid-connect/auth';\r\n                    },\r\n                    token: function() {\r\n                        return getRealmUrl() + '/protocol/openid-connect/token';\r\n                    },\r\n                    logout: function() {\r\n                        return getRealmUrl() + '/protocol/openid-connect/logout';\r\n                    },\r\n                    checkSessionIframe: function() {\r\n                        return getRealmUrl() + '/protocol/openid-connect/login-status-iframe.html';\r\n                    },\r\n                    thirdPartyCookiesIframe: function() {\r\n                        return getRealmUrl() + '/protocol/openid-connect/3p-cookies/step1.html';\r\n                    },\r\n                    register: function() {\r\n                        return getRealmUrl() + '/protocol/openid-connect/registrations';\r\n                    },\r\n                    userinfo: function() {\r\n                        return getRealmUrl() + '/protocol/openid-connect/userinfo';\r\n                    }\r\n                };\r\n            } else {\r\n                kc.endpoints = {\r\n                    authorize: function() {\r\n                        return oidcConfiguration.authorization_endpoint;\r\n                    },\r\n                    token: function() {\r\n                        return oidcConfiguration.token_endpoint;\r\n                    },\r\n                    logout: function() {\r\n                        if (!oidcConfiguration.end_session_endpoint) {\r\n                            throw \"Not supported by the OIDC server\";\r\n                        }\r\n                        return oidcConfiguration.end_session_endpoint;\r\n                    },\r\n                    checkSessionIframe: function() {\r\n                        if (!oidcConfiguration.check_session_iframe) {\r\n                            throw \"Not supported by the OIDC server\";\r\n                        }\r\n                        return oidcConfiguration.check_session_iframe;\r\n                    },\r\n                    register: function() {\r\n                        throw 'Redirection to \"Register user\" page not supported in standard OIDC mode';\r\n                    },\r\n                    userinfo: function() {\r\n                        if (!oidcConfiguration.userinfo_endpoint) {\r\n                            throw \"Not supported by the OIDC server\";\r\n                        }\r\n                        return oidcConfiguration.userinfo_endpoint;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        if (configUrl) {\r\n            var req = new XMLHttpRequest();\r\n            req.open('GET', configUrl, true);\r\n            req.setRequestHeader('Accept', 'application/json');\r\n\r\n            req.onreadystatechange = function () {\r\n                if (req.readyState == 4) {\r\n                    if (req.status == 200 || fileLoaded(req)) {\r\n                        var config = JSON.parse(req.responseText);\r\n\r\n                        kc.authServerUrl = config['auth-server-url'];\r\n                        kc.realm = config['realm'];\r\n                        kc.clientId = config['resource'];\r\n                        setupOidcEndoints(null);\r\n                        promise.setSuccess();\r\n                    } else {\r\n                        promise.setError();\r\n                    }\r\n                }\r\n            };\r\n\r\n            req.send();\r\n        } else {\r\n            kc.clientId = config.clientId;\r\n\r\n            var oidcProvider = config['oidcProvider'];\r\n            if (!oidcProvider) {\r\n                kc.authServerUrl = config.url;\r\n                kc.realm = config.realm;\r\n                setupOidcEndoints(null);\r\n                promise.setSuccess();\r\n            } else {\r\n                if (typeof oidcProvider === 'string') {\r\n                    var oidcProviderConfigUrl;\r\n                    if (oidcProvider.charAt(oidcProvider.length - 1) == '/') {\r\n                        oidcProviderConfigUrl = oidcProvider + '.well-known/openid-configuration';\r\n                    } else {\r\n                        oidcProviderConfigUrl = oidcProvider + '/.well-known/openid-configuration';\r\n                    }\r\n                    var req = new XMLHttpRequest();\r\n                    req.open('GET', oidcProviderConfigUrl, true);\r\n                    req.setRequestHeader('Accept', 'application/json');\r\n\r\n                    req.onreadystatechange = function () {\r\n                        if (req.readyState == 4) {\r\n                            if (req.status == 200 || fileLoaded(req)) {\r\n                                var oidcProviderConfig = JSON.parse(req.responseText);\r\n                                setupOidcEndoints(oidcProviderConfig);\r\n                                promise.setSuccess();\r\n                            } else {\r\n                                promise.setError();\r\n                            }\r\n                        }\r\n                    };\r\n\r\n                    req.send();\r\n                } else {\r\n                    setupOidcEndoints(oidcProvider);\r\n                    promise.setSuccess();\r\n                }\r\n            }\r\n        }\r\n\r\n        return promise.promise;\r\n    }\r\n\r\n    function fileLoaded(xhr) {\r\n        return xhr.status == 0 && xhr.responseText && xhr.responseURL.startsWith('file:');\r\n    }\r\n\r\n    function setToken(token, refreshToken, idToken, timeLocal) {\r\n        if (kc.tokenTimeoutHandle) {\r\n            clearTimeout(kc.tokenTimeoutHandle);\r\n            kc.tokenTimeoutHandle = null;\r\n        }\r\n\r\n        if (refreshToken) {\r\n            kc.refreshToken = refreshToken;\r\n            kc.refreshTokenParsed = decodeToken(refreshToken);\r\n        } else {\r\n            delete kc.refreshToken;\r\n            delete kc.refreshTokenParsed;\r\n        }\r\n\r\n        if (idToken) {\r\n            kc.idToken = idToken;\r\n            kc.idTokenParsed = decodeToken(idToken);\r\n        } else {\r\n            delete kc.idToken;\r\n            delete kc.idTokenParsed;\r\n        }\r\n\r\n        if (token) {\r\n            kc.token = token;\r\n            kc.tokenParsed = decodeToken(token);\r\n            kc.sessionId = kc.tokenParsed.sid;\r\n            kc.authenticated = true;\r\n            kc.subject = kc.tokenParsed.sub;\r\n            kc.realmAccess = kc.tokenParsed.realm_access;\r\n            kc.resourceAccess = kc.tokenParsed.resource_access;\r\n\r\n            if (timeLocal) {\r\n                kc.timeSkew = Math.floor(timeLocal / 1000) - kc.tokenParsed.iat;\r\n            }\r\n\r\n            if (kc.timeSkew != null) {\r\n                logInfo('[KEYCLOAK] Estimated time difference between browser and server is ' + kc.timeSkew + ' seconds');\r\n\r\n                if (kc.onTokenExpired) {\r\n                    var expiresIn = (kc.tokenParsed['exp'] - (new Date().getTime() / 1000) + kc.timeSkew) * 1000;\r\n                    logInfo('[KEYCLOAK] Token expires in ' + Math.round(expiresIn / 1000) + ' s');\r\n                    if (expiresIn <= 0) {\r\n                        kc.onTokenExpired();\r\n                    } else {\r\n                        kc.tokenTimeoutHandle = setTimeout(kc.onTokenExpired, expiresIn);\r\n                    }\r\n                }\r\n            }\r\n        } else {\r\n            delete kc.token;\r\n            delete kc.tokenParsed;\r\n            delete kc.subject;\r\n            delete kc.realmAccess;\r\n            delete kc.resourceAccess;\r\n\r\n            kc.authenticated = false;\r\n        }\r\n    }\r\n\r\n    function createUUID() {\r\n        if (typeof crypto === \"undefined\" || typeof crypto.randomUUID === \"undefined\") {\r\n            throw new Error(\"Web Crypto API is not available.\");\r\n        }\r\n\r\n        return crypto.randomUUID();\r\n    }\r\n\r\n    function parseCallback(url) {\r\n        var oauth = parseCallbackUrl(url);\r\n        if (!oauth) {\r\n            return;\r\n        }\r\n\r\n        var oauthState = callbackStorage.get(oauth.state);\r\n\r\n        if (oauthState) {\r\n            oauth.valid = true;\r\n            oauth.redirectUri = oauthState.redirectUri;\r\n            oauth.storedNonce = oauthState.nonce;\r\n            oauth.prompt = oauthState.prompt;\r\n            oauth.pkceCodeVerifier = oauthState.pkceCodeVerifier;\r\n            oauth.loginOptions = oauthState.loginOptions;\r\n        }\r\n\r\n        return oauth;\r\n    }\r\n\r\n    function parseCallbackUrl(url) {\r\n        var supportedParams;\r\n        switch (kc.flow) {\r\n            case 'standard':\r\n                supportedParams = ['code', 'state', 'session_state', 'kc_action_status', 'kc_action', 'iss'];\r\n                break;\r\n            case 'implicit':\r\n                supportedParams = ['access_token', 'token_type', 'id_token', 'state', 'session_state', 'expires_in', 'kc_action_status', 'kc_action', 'iss'];\r\n                break;\r\n            case 'hybrid':\r\n                supportedParams = ['access_token', 'token_type', 'id_token', 'code', 'state', 'session_state', 'expires_in', 'kc_action_status', 'kc_action', 'iss'];\r\n                break;\r\n        }\r\n\r\n        supportedParams.push('error');\r\n        supportedParams.push('error_description');\r\n        supportedParams.push('error_uri');\r\n\r\n        var queryIndex = url.indexOf('?');\r\n        var fragmentIndex = url.indexOf('#');\r\n\r\n        var newUrl;\r\n        var parsed;\r\n\r\n        if (kc.responseMode === 'query' && queryIndex !== -1) {\r\n            newUrl = url.substring(0, queryIndex);\r\n            parsed = parseCallbackParams(url.substring(queryIndex + 1, fragmentIndex !== -1 ? fragmentIndex : url.length), supportedParams);\r\n            if (parsed.paramsString !== '') {\r\n                newUrl += '?' + parsed.paramsString;\r\n            }\r\n            if (fragmentIndex !== -1) {\r\n                newUrl += url.substring(fragmentIndex);\r\n            }\r\n        } else if (kc.responseMode === 'fragment' && fragmentIndex !== -1) {\r\n            newUrl = url.substring(0, fragmentIndex);\r\n            parsed = parseCallbackParams(url.substring(fragmentIndex + 1), supportedParams);\r\n            if (parsed.paramsString !== '') {\r\n                newUrl += '#' + parsed.paramsString;\r\n            }\r\n        }\r\n\r\n        if (parsed && parsed.oauthParams) {\r\n            if (kc.flow === 'standard' || kc.flow === 'hybrid') {\r\n                if ((parsed.oauthParams.code || parsed.oauthParams.error) && parsed.oauthParams.state) {\r\n                    parsed.oauthParams.newUrl = newUrl;\r\n                    return parsed.oauthParams;\r\n                }\r\n            } else if (kc.flow === 'implicit') {\r\n                if ((parsed.oauthParams.access_token || parsed.oauthParams.error) && parsed.oauthParams.state) {\r\n                    parsed.oauthParams.newUrl = newUrl;\r\n                    return parsed.oauthParams;\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    function parseCallbackParams(paramsString, supportedParams) {\r\n        var p = paramsString.split('&');\r\n        var result = {\r\n            paramsString: '',\r\n            oauthParams: {}\r\n        }\r\n        for (var i = 0; i < p.length; i++) {\r\n            var split = p[i].indexOf(\"=\");\r\n            var key = p[i].slice(0, split);\r\n            if (supportedParams.indexOf(key) !== -1) {\r\n                result.oauthParams[key] = p[i].slice(split + 1);\r\n            } else {\r\n                if (result.paramsString !== '') {\r\n                    result.paramsString += '&';\r\n                }\r\n                result.paramsString += p[i];\r\n            }\r\n        }\r\n        return result;\r\n    }\r\n\r\n    function createPromise() {\r\n        // Need to create a native Promise which also preserves the\r\n        // interface of the custom promise type previously used by the API\r\n        var p = {\r\n            setSuccess: function(result) {\r\n                p.resolve(result);\r\n            },\r\n\r\n            setError: function(result) {\r\n                p.reject(result);\r\n            }\r\n        };\r\n        p.promise = new Promise(function(resolve, reject) {\r\n            p.resolve = resolve;\r\n            p.reject = reject;\r\n        });\r\n\r\n        return p;\r\n    }\r\n\r\n    // Function to extend existing native Promise with timeout\r\n    function applyTimeoutToPromise(promise, timeout, errorMessage) {\r\n        var timeoutHandle = null;\r\n        var timeoutPromise = new Promise(function (resolve, reject) {\r\n            timeoutHandle = setTimeout(function () {\r\n                reject({ \"error\": errorMessage || \"Promise is not settled within timeout of \" + timeout + \"ms\" });\r\n            }, timeout);\r\n        });\r\n\r\n        return Promise.race([promise, timeoutPromise]).finally(function () {\r\n            clearTimeout(timeoutHandle);\r\n        });\r\n    }\r\n\r\n    function setupCheckLoginIframe() {\r\n        var promise = createPromise();\r\n\r\n        if (!loginIframe.enable) {\r\n            promise.setSuccess();\r\n            return promise.promise;\r\n        }\r\n\r\n        if (loginIframe.iframe) {\r\n            promise.setSuccess();\r\n            return promise.promise;\r\n        }\r\n\r\n        var iframe = document.createElement('iframe');\r\n        loginIframe.iframe = iframe;\r\n\r\n        iframe.onload = function() {\r\n            var authUrl = kc.endpoints.authorize();\r\n            if (authUrl.charAt(0) === '/') {\r\n                loginIframe.iframeOrigin = getOrigin();\r\n            } else {\r\n                loginIframe.iframeOrigin = authUrl.substring(0, authUrl.indexOf('/', 8));\r\n            }\r\n            promise.setSuccess();\r\n        }\r\n\r\n        var src = kc.endpoints.checkSessionIframe();\r\n        iframe.setAttribute('src', src );\r\n        iframe.setAttribute('sandbox', 'allow-storage-access-by-user-activation allow-scripts allow-same-origin');\r\n        iframe.setAttribute('title', 'keycloak-session-iframe' );\r\n        iframe.style.display = 'none';\r\n        document.body.appendChild(iframe);\r\n\r\n        var messageCallback = function(event) {\r\n            if ((event.origin !== loginIframe.iframeOrigin) || (loginIframe.iframe.contentWindow !== event.source)) {\r\n                return;\r\n            }\r\n\r\n            if (!(event.data == 'unchanged' || event.data == 'changed' || event.data == 'error')) {\r\n                return;\r\n            }\r\n\r\n\r\n            if (event.data != 'unchanged') {\r\n                kc.clearToken();\r\n            }\r\n\r\n            var callbacks = loginIframe.callbackList.splice(0, loginIframe.callbackList.length);\r\n\r\n            for (var i = callbacks.length - 1; i >= 0; --i) {\r\n                var promise = callbacks[i];\r\n                if (event.data == 'error') {\r\n                    promise.setError();\r\n                } else {\r\n                    promise.setSuccess(event.data == 'unchanged');\r\n                }\r\n            }\r\n        };\r\n\r\n        window.addEventListener('message', messageCallback, false);\r\n\r\n        return promise.promise;\r\n    }\r\n\r\n    function scheduleCheckIframe() {\r\n        if (loginIframe.enable) {\r\n            if (kc.token) {\r\n                setTimeout(function() {\r\n                    checkLoginIframe().then(function(unchanged) {\r\n                        if (unchanged) {\r\n                            scheduleCheckIframe();\r\n                        }\r\n                    });\r\n                }, loginIframe.interval * 1000);\r\n            }\r\n        }\r\n    }\r\n\r\n    function checkLoginIframe() {\r\n        var promise = createPromise();\r\n\r\n        if (loginIframe.iframe && loginIframe.iframeOrigin ) {\r\n            var msg = kc.clientId + ' ' + (kc.sessionId ? kc.sessionId : '');\r\n            loginIframe.callbackList.push(promise);\r\n            var origin = loginIframe.iframeOrigin;\r\n            if (loginIframe.callbackList.length == 1) {\r\n                loginIframe.iframe.contentWindow.postMessage(msg, origin);\r\n            }\r\n        } else {\r\n            promise.setSuccess();\r\n        }\r\n\r\n        return promise.promise;\r\n    }\r\n\r\n    function check3pCookiesSupported() {\r\n        var promise = createPromise();\r\n\r\n        if ((loginIframe.enable || kc.silentCheckSsoRedirectUri) && typeof kc.endpoints.thirdPartyCookiesIframe === 'function') {\r\n            var iframe = document.createElement('iframe');\r\n            iframe.setAttribute('src', kc.endpoints.thirdPartyCookiesIframe());\r\n            iframe.setAttribute('sandbox', 'allow-storage-access-by-user-activation allow-scripts allow-same-origin');\r\n            iframe.setAttribute('title', 'keycloak-3p-check-iframe' );\r\n            iframe.style.display = 'none';\r\n            document.body.appendChild(iframe);\r\n\r\n            var messageCallback = function(event) {\r\n                if (iframe.contentWindow !== event.source) {\r\n                    return;\r\n                }\r\n\r\n                if (event.data !== \"supported\" && event.data !== \"unsupported\") {\r\n                    return;\r\n                } else if (event.data === \"unsupported\") {\r\n                    logWarn(\r\n                        \"[KEYCLOAK] Your browser is blocking access to 3rd-party cookies, this means:\\n\\n\" +\r\n                        \" - It is not possible to retrieve tokens without redirecting to the Keycloak server (a.k.a. no support for silent authentication).\\n\" +\r\n                        \" - It is not possible to automatically detect changes to the session status (such as the user logging out in another tab).\\n\\n\" +\r\n                        \"For more information see: https://www.keycloak.org/docs/latest/securing_apps/#_modern_browsers\"\r\n                    );\r\n\r\n                    loginIframe.enable = false;\r\n                    if (kc.silentCheckSsoFallback) {\r\n                        kc.silentCheckSsoRedirectUri = false;\r\n                    }\r\n                }\r\n\r\n                document.body.removeChild(iframe);\r\n                window.removeEventListener(\"message\", messageCallback);\r\n                promise.setSuccess();\r\n            };\r\n\r\n            window.addEventListener('message', messageCallback, false);\r\n        } else {\r\n            promise.setSuccess();\r\n        }\r\n\r\n        return applyTimeoutToPromise(promise.promise, kc.messageReceiveTimeout, \"Timeout when waiting for 3rd party check iframe message.\");\r\n    }\r\n\r\n    function loadAdapter(type) {\r\n        if (!type || type == 'default') {\r\n            return {\r\n                login: async function(options) {\r\n                    window.location.assign(await kc.createLoginUrl(options));\r\n                    return createPromise().promise;\r\n                },\r\n\r\n                logout: async function(options) {\r\n\r\n                    const logoutMethod = options?.logoutMethod ?? kc.logoutMethod;\r\n                    if (logoutMethod === \"GET\") {\r\n                        window.location.replace(kc.createLogoutUrl(options));\r\n                        return;\r\n                    }\r\n\r\n                    const logoutUrl = kc.createLogoutUrl(options);\r\n                    const response = await fetch(logoutUrl, {\r\n                        method: \"POST\",\r\n                        headers: {\r\n                            \"Content-Type\": \"application/x-www-form-urlencoded\"\r\n                        },\r\n                        body: new URLSearchParams({\r\n                            id_token_hint: kc.idToken,\r\n                            client_id: kc.clientId,\r\n                            post_logout_redirect_uri: adapter.redirectUri(options, false)\r\n                        })\r\n                    });\r\n\r\n                    if (response.redirected) {\r\n                        window.location.href = response.url;\r\n                        return;\r\n                    }\r\n\r\n                    if (response.ok) {\r\n                        window.location.reload();\r\n                        return;\r\n                    }\r\n\r\n                    throw new Error(\"Logout failed, request returned an error code.\");\r\n                },\r\n\r\n                register: async function(options) {\r\n                    window.location.assign(await kc.createRegisterUrl(options));\r\n                    return createPromise().promise;\r\n                },\r\n\r\n                accountManagement : function() {\r\n                    var accountUrl = kc.createAccountUrl();\r\n                    if (typeof accountUrl !== 'undefined') {\r\n                        window.location.href = accountUrl;\r\n                    } else {\r\n                        throw \"Not supported by the OIDC server\";\r\n                    }\r\n                    return createPromise().promise;\r\n                },\r\n\r\n                redirectUri: function(options, encodeHash) {\r\n                    if (arguments.length == 1) {\r\n                        encodeHash = true;\r\n                    }\r\n\r\n                    if (options && options.redirectUri) {\r\n                        return options.redirectUri;\r\n                    } else if (kc.redirectUri) {\r\n                        return kc.redirectUri;\r\n                    } else {\r\n                        return location.href;\r\n                    }\r\n                }\r\n            };\r\n        }\r\n\r\n        if (type == 'cordova') {\r\n            loginIframe.enable = false;\r\n            var cordovaOpenWindowWrapper = function(loginUrl, target, options) {\r\n                if (window.cordova && window.cordova.InAppBrowser) {\r\n                    // Use inappbrowser for IOS and Android if available\r\n                    return window.cordova.InAppBrowser.open(loginUrl, target, options);\r\n                } else {\r\n                    return window.open(loginUrl, target, options);\r\n                }\r\n            };\r\n\r\n            var shallowCloneCordovaOptions = function (userOptions) {\r\n                if (userOptions && userOptions.cordovaOptions) {\r\n                    return Object.keys(userOptions.cordovaOptions).reduce(function (options, optionName) {\r\n                        options[optionName] = userOptions.cordovaOptions[optionName];\r\n                        return options;\r\n                    }, {});\r\n                } else {\r\n                    return {};\r\n                }\r\n            };\r\n\r\n            var formatCordovaOptions = function (cordovaOptions) {\r\n                return Object.keys(cordovaOptions).reduce(function (options, optionName) {\r\n                    options.push(optionName+\"=\"+cordovaOptions[optionName]);\r\n                    return options;\r\n                }, []).join(\",\");\r\n            };\r\n\r\n            var createCordovaOptions = function (userOptions) {\r\n                var cordovaOptions = shallowCloneCordovaOptions(userOptions);\r\n                cordovaOptions.location = 'no';\r\n                if (userOptions && userOptions.prompt == 'none') {\r\n                    cordovaOptions.hidden = 'yes';\r\n                }\r\n                return formatCordovaOptions(cordovaOptions);\r\n            };\r\n\r\n            var getCordovaRedirectUri = function() {\r\n                return kc.redirectUri || 'http://localhost';\r\n            }\r\n\r\n            return {\r\n                login: async function(options) {\r\n                    var promise = createPromise();\r\n\r\n                    var cordovaOptions = createCordovaOptions(options);\r\n                    var loginUrl = await kc.createLoginUrl(options);\r\n                    var ref = cordovaOpenWindowWrapper(loginUrl, '_blank', cordovaOptions);\r\n                    var completed = false;\r\n\r\n                    var closed = false;\r\n                    var closeBrowser = function() {\r\n                        closed = true;\r\n                        ref.close();\r\n                    };\r\n\r\n                    ref.addEventListener('loadstart', function(event) {\r\n                        if (event.url.indexOf(getCordovaRedirectUri()) == 0) {\r\n                            var callback = parseCallback(event.url);\r\n                            processCallback(callback, promise);\r\n                            closeBrowser();\r\n                            completed = true;\r\n                        }\r\n                    });\r\n\r\n                    ref.addEventListener('loaderror', function(event) {\r\n                        if (!completed) {\r\n                            if (event.url.indexOf(getCordovaRedirectUri()) == 0) {\r\n                                var callback = parseCallback(event.url);\r\n                                processCallback(callback, promise);\r\n                                closeBrowser();\r\n                                completed = true;\r\n                            } else {\r\n                                promise.setError();\r\n                                closeBrowser();\r\n                            }\r\n                        }\r\n                    });\r\n\r\n                    ref.addEventListener('exit', function(event) {\r\n                        if (!closed) {\r\n                            promise.setError({\r\n                                reason: \"closed_by_user\"\r\n                            });\r\n                        }\r\n                    });\r\n\r\n                    return promise.promise;\r\n                },\r\n\r\n                logout: function(options) {\r\n                    var promise = createPromise();\r\n\r\n                    var logoutUrl = kc.createLogoutUrl(options);\r\n                    var ref = cordovaOpenWindowWrapper(logoutUrl, '_blank', 'location=no,hidden=yes,clearcache=yes');\r\n\r\n                    var error;\r\n\r\n                    ref.addEventListener('loadstart', function(event) {\r\n                        if (event.url.indexOf(getCordovaRedirectUri()) == 0) {\r\n                            ref.close();\r\n                        }\r\n                    });\r\n\r\n                    ref.addEventListener('loaderror', function(event) {\r\n                        if (event.url.indexOf(getCordovaRedirectUri()) == 0) {\r\n                            ref.close();\r\n                        } else {\r\n                            error = true;\r\n                            ref.close();\r\n                        }\r\n                    });\r\n\r\n                    ref.addEventListener('exit', function(event) {\r\n                        if (error) {\r\n                            promise.setError();\r\n                        } else {\r\n                            kc.clearToken();\r\n                            promise.setSuccess();\r\n                        }\r\n                    });\r\n\r\n                    return promise.promise;\r\n                },\r\n\r\n                register : async function(options) {\r\n                    var promise = createPromise();\r\n                    var registerUrl = await kc.createRegisterUrl();\r\n                    var cordovaOptions = createCordovaOptions(options);\r\n                    var ref = cordovaOpenWindowWrapper(registerUrl, '_blank', cordovaOptions);\r\n                    ref.addEventListener('loadstart', function(event) {\r\n                        if (event.url.indexOf(getCordovaRedirectUri()) == 0) {\r\n                            ref.close();\r\n                            var oauth = parseCallback(event.url);\r\n                            processCallback(oauth, promise);\r\n                        }\r\n                    });\r\n                    return promise.promise;\r\n                },\r\n\r\n                accountManagement : function() {\r\n                    var accountUrl = kc.createAccountUrl();\r\n                    if (typeof accountUrl !== 'undefined') {\r\n                        var ref = cordovaOpenWindowWrapper(accountUrl, '_blank', 'location=no');\r\n                        ref.addEventListener('loadstart', function(event) {\r\n                            if (event.url.indexOf(getCordovaRedirectUri()) == 0) {\r\n                                ref.close();\r\n                            }\r\n                        });\r\n                    } else {\r\n                        throw \"Not supported by the OIDC server\";\r\n                    }\r\n                },\r\n\r\n                redirectUri: function(options) {\r\n                    return getCordovaRedirectUri();\r\n                }\r\n            }\r\n        }\r\n\r\n        if (type == 'cordova-native') {\r\n            loginIframe.enable = false;\r\n\r\n            return {\r\n                login: async function(options) {\r\n                    var promise = createPromise();\r\n                    var loginUrl = await kc.createLoginUrl(options);\r\n\r\n                    universalLinks.subscribe('keycloak', function(event) {\r\n                        universalLinks.unsubscribe('keycloak');\r\n                        window.cordova.plugins.browsertab.close();\r\n                        var oauth = parseCallback(event.url);\r\n                        processCallback(oauth, promise);\r\n                    });\r\n\r\n                    window.cordova.plugins.browsertab.openUrl(loginUrl);\r\n                    return promise.promise;\r\n                },\r\n\r\n                logout: function(options) {\r\n                    var promise = createPromise();\r\n                    var logoutUrl = kc.createLogoutUrl(options);\r\n\r\n                    universalLinks.subscribe('keycloak', function(event) {\r\n                        universalLinks.unsubscribe('keycloak');\r\n                        window.cordova.plugins.browsertab.close();\r\n                        kc.clearToken();\r\n                        promise.setSuccess();\r\n                    });\r\n\r\n                    window.cordova.plugins.browsertab.openUrl(logoutUrl);\r\n                    return promise.promise;\r\n                },\r\n\r\n                register : async function(options) {\r\n                    var promise = createPromise();\r\n                    var registerUrl = await kc.createRegisterUrl(options);\r\n                    universalLinks.subscribe('keycloak' , function(event) {\r\n                        universalLinks.unsubscribe('keycloak');\r\n                        window.cordova.plugins.browsertab.close();\r\n                        var oauth = parseCallback(event.url);\r\n                        processCallback(oauth, promise);\r\n                    });\r\n                    window.cordova.plugins.browsertab.openUrl(registerUrl);\r\n                    return promise.promise;\r\n\r\n                },\r\n\r\n                accountManagement : function() {\r\n                    var accountUrl = kc.createAccountUrl();\r\n                    if (typeof accountUrl !== 'undefined') {\r\n                        window.cordova.plugins.browsertab.openUrl(accountUrl);\r\n                    } else {\r\n                        throw \"Not supported by the OIDC server\";\r\n                    }\r\n                },\r\n\r\n                redirectUri: function(options) {\r\n                    if (options && options.redirectUri) {\r\n                        return options.redirectUri;\r\n                    } else if (kc.redirectUri) {\r\n                        return kc.redirectUri;\r\n                    } else {\r\n                        return \"http://localhost\";\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        throw 'invalid adapter type: ' + type;\r\n    }\r\n\r\n    const STORAGE_KEY_PREFIX = 'kc-callback-';\r\n\r\n    var LocalStorage = function() {\r\n        if (!(this instanceof LocalStorage)) {\r\n            return new LocalStorage();\r\n        }\r\n\r\n        localStorage.setItem('kc-test', 'test');\r\n        localStorage.removeItem('kc-test');\r\n\r\n        var cs = this;\r\n\r\n        /**\r\n         * Clears all values from local storage that are no longer valid.\r\n         */\r\n        function clearInvalidValues() {\r\n            const currentTime = Date.now();\r\n\r\n            for (const [key, value] of getStoredEntries()) {\r\n                // Attempt to parse the expiry time from the value.\r\n                const expiry = parseExpiry(value);\r\n\r\n                // Discard the value if it is malformed or expired.\r\n                if (expiry === null || expiry < currentTime) {\r\n                    localStorage.removeItem(key);\r\n                }\r\n            }\r\n        }\r\n\r\n        /**\r\n         * Clears all known values from local storage.\r\n         */\r\n        function clearAllValues() {\r\n            for (const [key] of getStoredEntries()) {\r\n                localStorage.removeItem(key);\r\n            }\r\n        }\r\n\r\n        /**\r\n         * Gets all entries stored in local storage that are known to be managed by this class.\r\n         * @returns {Array<[string, unknown]>} An array of key-value pairs.\r\n         */\r\n        function getStoredEntries() {\r\n            return Object.entries(localStorage).filter(([key]) => key.startsWith(STORAGE_KEY_PREFIX));\r\n        }\r\n\r\n        /**\r\n         * Parses the expiry time from a value stored in local storage.\r\n         * @param {unknown} value\r\n         * @returns {number | null} The expiry time in milliseconds, or `null` if the value is malformed.\r\n         */\r\n        function parseExpiry(value) {\r\n            let parsedValue;\r\n\r\n            // Attempt to parse the value as JSON.\r\n            try {\r\n                parsedValue = JSON.parse(value);\r\n            } catch (error) {\r\n                return null;\r\n            }\r\n\r\n            // Attempt to extract the 'expires' property.\r\n            if (isObject(parsedValue) && 'expires' in parsedValue && typeof parsedValue.expires === 'number') {\r\n                return parsedValue.expires;\r\n            }\r\n\r\n            return null;\r\n        }\r\n\r\n        cs.get = function(state) {\r\n            if (!state) {\r\n                return;\r\n            }\r\n\r\n            var key = STORAGE_KEY_PREFIX + state;\r\n            var value = localStorage.getItem(key);\r\n            if (value) {\r\n                localStorage.removeItem(key);\r\n                value = JSON.parse(value);\r\n            }\r\n\r\n            clearInvalidValues();\r\n            return value;\r\n        };\r\n\r\n        cs.add = function(state) {\r\n            clearInvalidValues();\r\n\r\n            const key = STORAGE_KEY_PREFIX + state.state;\r\n            const value = JSON.stringify({\r\n                ...state,\r\n                // Set the expiry time to 1 hour from now.\r\n                expires: Date.now() + (60 * 60 * 1000)\r\n            });\r\n\r\n            try {\r\n                localStorage.setItem(key, value);\r\n            } catch (error) {\r\n                // If the storage is full, clear all known values and try again.\r\n                clearAllValues();\r\n                localStorage.setItem(key, value);\r\n            }\r\n        };\r\n    };\r\n\r\n    var CookieStorage = function() {\r\n        if (!(this instanceof CookieStorage)) {\r\n            return new CookieStorage();\r\n        }\r\n\r\n        var cs = this;\r\n\r\n        cs.get = function(state) {\r\n            if (!state) {\r\n                return;\r\n            }\r\n\r\n            var value = getCookie(STORAGE_KEY_PREFIX + state);\r\n            setCookie(STORAGE_KEY_PREFIX + state, '', cookieExpiration(-100));\r\n            if (value) {\r\n                return JSON.parse(value);\r\n            }\r\n        };\r\n\r\n        cs.add = function(state) {\r\n            setCookie(STORAGE_KEY_PREFIX + state.state, JSON.stringify(state), cookieExpiration(60));\r\n        };\r\n\r\n        cs.removeItem = function(key) {\r\n            setCookie(key, '', cookieExpiration(-100));\r\n        };\r\n\r\n        var cookieExpiration = function (minutes) {\r\n            var exp = new Date();\r\n            exp.setTime(exp.getTime() + (minutes*60*1000));\r\n            return exp;\r\n        };\r\n\r\n        var getCookie = function (key) {\r\n            var name = key + '=';\r\n            var ca = document.cookie.split(';');\r\n            for (var i = 0; i < ca.length; i++) {\r\n                var c = ca[i];\r\n                while (c.charAt(0) == ' ') {\r\n                    c = c.substring(1);\r\n                }\r\n                if (c.indexOf(name) == 0) {\r\n                    return c.substring(name.length, c.length);\r\n                }\r\n            }\r\n            return '';\r\n        };\r\n\r\n        var setCookie = function (key, value, expirationDate) {\r\n            var cookie = key + '=' + value + '; '\r\n                + 'expires=' + expirationDate.toUTCString() + '; ';\r\n            document.cookie = cookie;\r\n        }\r\n    };\r\n\r\n    function createCallbackStorage() {\r\n        try {\r\n            return new LocalStorage();\r\n        } catch (err) {\r\n        }\r\n\r\n        return new CookieStorage();\r\n    }\r\n\r\n    function createLogger(fn) {\r\n        return function() {\r\n            if (kc.enableLogging) {\r\n                fn.apply(console, Array.prototype.slice.call(arguments));\r\n            }\r\n        };\r\n    }\r\n}\r\n\r\nexport default Keycloak;\r\n\r\n/**\r\n * @param {ArrayBuffer} bytes\r\n * @see https://developer.mozilla.org/en-US/docs/Glossary/Base64#the_unicode_problem\r\n */\r\nfunction bytesToBase64(bytes) {\r\n    const binString = String.fromCodePoint(...bytes);\r\n    return btoa(binString);\r\n}\r\n\r\n/**\r\n * @param {string} message\r\n * @see https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/digest#basic_example\r\n */\r\nasync function sha256Digest(message) {\r\n    const encoder = new TextEncoder();\r\n    const data = encoder.encode(message);\r\n\r\n    if (typeof crypto === \"undefined\" || typeof crypto.subtle === \"undefined\") {\r\n        throw new Error(\"Web Crypto API is not available.\");\r\n    }\r\n\r\n    return await crypto.subtle.digest(\"SHA-256\", data);\r\n}\r\n\r\n/**\r\n * @param {string} token\r\n */\r\nfunction decodeToken(token) {\r\n    const [header, payload] = token.split(\".\");\r\n\r\n    if (typeof payload !== \"string\") {\r\n        throw new Error(\"Unable to decode token, payload not found.\");\r\n    }\r\n\r\n    let decoded;\r\n\r\n    try {\r\n        decoded = base64UrlDecode(payload);\r\n    } catch (error) {\r\n        throw new Error(\"Unable to decode token, payload is not a valid Base64URL value.\", { cause: error });\r\n    }\r\n\r\n    try {\r\n        return JSON.parse(decoded);\r\n    } catch (error) {\r\n        throw new Error(\"Unable to decode token, payload is not a valid JSON value.\", { cause: error });\r\n    }\r\n}\r\n\r\n/**\r\n * @param {string} input\r\n */\r\nfunction base64UrlDecode(input) {\r\n    let output = input\r\n        .replaceAll(\"-\", \"+\")\r\n        .replaceAll(\"_\", \"/\");\r\n\r\n    switch (output.length % 4) {\r\n        case 0:\r\n            break;\r\n        case 2:\r\n            output += \"==\";\r\n            break;\r\n        case 3:\r\n            output += \"=\";\r\n            break;\r\n        default:\r\n            throw new Error(\"Input is not of the correct length.\");\r\n    }\r\n\r\n    try {\r\n        return b64DecodeUnicode(output);\r\n    } catch (error) {\r\n        return atob(output);\r\n    }\r\n}\r\n\r\n/**\r\n * @param {string} input\r\n */\r\nfunction b64DecodeUnicode(input) {\r\n    return decodeURIComponent(atob(input).replace(/(.)/g, (m, p) => {\r\n        let code = p.charCodeAt(0).toString(16).toUpperCase();\r\n\r\n        if (code.length < 2) {\r\n            code = \"0\" + code;\r\n        }\r\n\r\n        return \"%\" + code;\r\n    }));\r\n}\r\n\r\n/**\r\n * Check if the input is an object that can be operated on.\r\n * @param {unknown} input\r\n */\r\nfunction isObject(input) {\r\n    return typeof input === 'object' && input !== null;\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}